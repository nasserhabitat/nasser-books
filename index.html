<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مكتبة ناصر ابن داوود</title>
    <meta name="description" content="مكتبة رقمية لمؤلفات الباحث الإسلامي والمهندس ناصر ابن داوود في علوم القرآن والتدبر">
    <meta property="og:title" content="مكتبة ناصر ابن داوود - مؤلفات في علوم القرآن">
    <meta property="og:description" content="مكتبة رقمية شاملة لمؤلفات الباحث الإسلامي ناصر ابن داوود">
    <meta property="og:image" content="https://nasser-ibn-dawood.com/assets/logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1a5276;
            --secondary-color: #2980b9;
            --accent-color: #e74c3c;
            --light-color: #f5f5f5;
            --dark-color: #333;
            --new-badge-color: #27ae60;
            --new-section-bg: #f9f7f0;
            --search-highlight: #ffeb3b;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f9f9f9;
            color: var(--dark-color);
            line-height: 1.6;
        }
        
        .update-banner {
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            padding: 8px;
            font-size: 0.9rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .hero {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            text-align: center;
            padding: 3rem 1rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        
        .hero::before {
            content: "";
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Q50,80 0,100 Z" fill="rgba(255,255,255,0.1)"/></svg>');
            background-size: 100% 100%;
            opacity: 0.3;
        }
        
        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 1.5rem;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }
        
        .section-title {
            text-align: center;
            margin: 2rem 0;
            color: var(--primary-color);
            font-size: 1.8rem;
            position: relative;
            padding-bottom: 10px;
        }
        
        .section-title::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: var(--primary-color);
            border-radius: 3px;
        }
        
        .filter-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .filter-buttons button {
            padding: 8px 20px;
            border: 2px solid var(--primary-color);
            background: white;
            color: var(--primary-color);
            border-radius: 30px;
            cursor: pointer;
            font-family: 'Tajawal', sans-serif;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .filter-buttons button.active {
            background: var(--primary-color);
            color: white;
        }
        
        .filter-buttons button:hover {
            background: var(--primary-color);
            color: white;
        }
        
        .book-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        .book-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }
        
        .book-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .book-cover {
            position: relative;
        }
        
        .book-cover img {
            width: 100%;
            height: auto;
            display: block;
            border-bottom: 1px solid #eee;
        }
        
        .book-info {
            padding: 1.5rem;
        }
        
        .book-card h2 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            font-size: 1.3rem;
        }
        
        .book-meta {
            color: #666;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }
        
        .book-desc {
            margin-bottom: 1.5rem;
            color: #555;
        }
        
        .book-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            display: inline-block;
            padding: 8px 20px;
            background: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background 0.3s ease;
            font-size: 0.9rem;
            text-align: center;
            flex: 1;
        }
        
        .btn:hover {
            background: var(--secondary-color);
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
        }
        
        .btn-outline:hover {
            background: var(--primary-color);
            color: white;
        }
        
        .search-container {
            max-width: 700px;
            margin: 30px auto;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .search-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border: 2px solid var(--primary-color);
            border-radius: 50px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            outline: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            background-color: white;
        }
        
        .search-input:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 4px rgba(41, 128, 185, 0.2);
            transform: translateY(-2px);
        }
        
        .search-input::placeholder {
            color: #999;
            opacity: 1;
        }
        
        .search-btn {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: transparent;
            border: none;
            cursor: pointer;
            color: var(--primary-color);
            padding: 0;
            transition: all 0.3s ease;
        }
        
        .search-input:focus + .search-btn {
            color: var(--secondary-color);
            transform: translateY(-50%) scale(1.1);
        }
        
        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 15px 15px;
            max-height: 400px;
            overflow-y: auto;
            z-index: 100;
            display: none;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .suggestion-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 1px solid #eee;
        }
        
        .suggestion-item:last-child {
            border-bottom: none;
        }
        
        .suggestion-item:hover {
            background: #f5f5f5;
            transform: translateX(-5px);
        }
        
        .suggestion-title {
            font-weight: 500;
            color: var(--primary-color);
            margin-bottom: 3px;
        }
        
        .suggestion-author {
            font-size: 0.9rem;
            color: #666;
        }
        
        .site-footer {
            background: var(--dark-color);
            color: white;
            text-align: center;
            padding: 2rem 1rem;
            margin-top: 3rem;
        }
        
        .footer-content p {
            margin-bottom: 0.5rem;
        }
        
        .search-input:active {
            transform: scale(0.98);
        }
        
        .new-books-section {
            background-color: var(--new-section-bg);
            padding: 2rem;
            border-radius: 15px;
            margin: 3rem 0;
            position: relative;
            overflow: hidden;
            border-left: 5px solid var(--new-badge-color);
        }
        
        .new-books-section::before {
            content: "";
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: rgba(39, 174, 96, 0.1);
            border-radius: 50%;
            transform: translate(50%, -50%);
        }
        
        .new-books-section::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 150px;
            height: 150px;
            background: rgba(39, 174, 96, 0.1);
            border-radius: 50%;
            transform: translate(-50%, 50%);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .section-title-new {
            color: var(--new-badge-color);
            font-size: 1.8rem;
            position: relative;
            padding-right: 20px;
            display: flex;
            align-items: center;
        }
        
        .section-title-new::before {
            content: "";
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 10px;
            height: 30px;
            background: var(--new-badge-color);
            border-radius: 5px;
        }
        
        .new-badge {
            background: var(--new-badge-color);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-right: 10px;
        }
        
        .new-badge::before {
            content: "🆕";
        }
        
        .book-card .new-badge-card {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--new-badge-color);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            z-index: 2;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .new-filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .new-filter-buttons button {
            padding: 8px 15px;
            border: 2px solid var(--new-badge-color);
            background: white;
            color: var(--new-badge-color);
            border-radius: 30px;
            cursor: pointer;
            font-family: 'Tajawal', sans-serif;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .new-filter-buttons button.active {
            background: var(--new-badge-color);
            color: white;
        }
        
        .new-filter-buttons button:hover {
            background: var(--new-badge-color);
            color: white;
        }
        
        .month-indicator {
            background: rgba(39, 174, 96, 0.15);
            padding: 5px 15px;
            border-radius: 20px;
            color: var(--new-badge-color);
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .month-indicator::before {
            content: "📅";
        }
        
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .search-container {
                margin: 20px 10px;
            }
            
            .search-input {
                padding: 12px 45px 12px 15px;
                font-size: 1rem;
            }
            
            .search-btn {
                left: 15px;
            }
            
            .book-grid {
                grid-template-columns: 1fr;
            }
            
            .new-books-section {
                padding: 1.5rem;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .new-filter-buttons {
                width: 100%;
            }
        }
        
        .search-info {
            text-align: center;
            margin: 15px 0;
            color: var(--primary-color);
            font-weight: 500;
            background: rgba(41, 128, 185, 0.1);
            padding: 10px;
            border-radius: 8px;
            display: none;
        }
        
        .highlight {
            background-color: var(--search-highlight);
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        .no-results {
            text-align: center;
            padding: 20px;
            color: #e74c3c;
            font-weight: 500;
            display: none;
        }
        
        .error-message {
            text-align: center;
            padding: 20px;
            color: #e74c3c;
            font-weight: 500;
            display: none;
        }
    </style>
</head>
<body>
    <div class="update-banner">
        🚀 المكتبة متجددة تلقائياً كل ساعة - آخر تحديث: <span id="last-update"></span>
    </div>
    
    <header class="hero">
        <div class="hero-content">
            <h1>مكتبة ناصر ابن داوود</h1>
            <p class="subtitle">مراجع إسلامية في علوم القرآن والتدبر</p>
            <div class="books-count">
                إجمالي الكتب: <span id="total-books-count">0</span> كتاب | 
                الجديد منها: <span id="new-books-count">0</span> كتاب
            </div>
            <div class="search-container">
                <input type="text" id="book-search" placeholder="ابحث عن كتاب أو مؤلف أو محتوى..." 
                       aria-label="بحث الكتب" class="search-input">
                <button class="search-btn" aria-label="تنفيذ البحث">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                    </svg>
                </button>
                <div class="search-suggestions" id="search-suggestions"></div>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="new-books-section">
            <div class="section-header">
                <div>
                    <h2 class="section-title-new">
                        <span class="new-badge">جديد</span> 
                        الإصدارات الحديثة
                    </h2>
                    <div class="month-indicator">شهر أغسطس 2025</div>
                </div>
                <div class="new-filter-buttons">
                    <button class="active" data-filter="all" aria-label="عرض جميع الكتب الجديدة">الكل</button>
                    <button data-filter="ar" aria-label="تصفية الكتب الجديدة بالعربية">العربية</button>
                    <button data-filter="en" aria-label="تصفية الكتب الجديدة بالإنجليزية">English</button>
                </div>
            </div>
            <div class="book-grid" id="new-book-grid"></div>
        </div>

        <h2 class="section-title">الكتب المتاحة</h2>
        <div class="filter-buttons">
            <button class="active" data-filter="all" aria-label="عرض جميع الكتب">الكل</button>
            <button data-filter="ar" aria-label="تصفية الكتب بالعربية">العربية</button>
            <button data-filter="en" aria-label="تصفية الكتب بالإنجليزية">English</button>
        </div>
        
        <div class="book-grid" id="book-grid"></div>
        
        <div class="search-info" id="search-info">
            تبحث عن: <strong id="search-term-display"></strong> | 
            عدد النتائج: <strong id="search-results-count">0</strong>
        </div>
        
        <div class="no-results" id="no-results">
            لم يتم العثور على كتب تطابق بحثك. حاول استخدام مصطلحات أخرى.
        </div>
        
        <div class="error-message" id="error-message">
            خطأ في تحميل بيانات الكتب. يرجى المحاولة لاحقاً.
        </div>
    </main>
    
    <footer class="site-footer">
        <div class="footer-content">
            <p>© 2025 مكتبة ناصر ابن داوود - مهندس وباحث إسلامي</p>
            <p>خريج كلية البوليتكنيك في جامعة مونس بلجيكا</p>
            <p>جميع الحقوق محفوظة - مُرخَّص للنشر والاقتباس بشرط ذكر المؤلف</p>
        </div>
    </footer>

    <script>
    // JSON data (embedded for simplicity; in production, fetch from index.json)
    const booksData = {
        "books": [
            {
                "id": "conscious-contemplation",
                "title": {
                    "ar": "نحو تدبر واع",
                    "en": "Towards Conscious Contemplation"
                },
                "description": {
                    "ar": "أحدث دراسة في منهجية التدبر القرآني وفق الرؤية المعاصرة (إصدار 2025)",
                    "en": "Cutting-edge study on Quranic contemplation methodology (2025 Edition)"
                },
                "path": {
                    "ar": "books/conscious-contemplation/ar/content.txt",
                    "en": "books/conscious-contemplation/en/content.txt"
                },
                "cover": {
                    "ar": "books/conscious-contemplation/ar/cover-ar.png",
                    "en": "books/conscious-contemplation/en/cover-en.png"
                },
                "year": 2025,
                "edition": "الطبعة الأولى 2025",
                "category": "التدبر القرآني",
                "keywords": [
                    "تدبر",
                    "منهجية",
                    "معاصرة",
                    "تدبر القرآن",
                    "فهم القرآن",
                    "تطبيق القرآن",
                    "منهجية التدبر",
                    "القرآن في العصر الحديث",
                    "نور العقل",
                    "رقمنة المخطوطات القرآنية",
                    "الرسم العثماني",
                    "المخطوطات القرآنية الأصلية",
                    "منهج حياة",
                    "الفهم الواعي للقرآن",
                    "آيات القرآن",
                    "القرآن الكريم",
                    "تدبر عملي",
                    "ناصر ابن داوود"
                ]
            },
            {
                "id": "anwar-al-bayan",
                "title": {
                    "ar": "أنوار البيان في رسم المصحف العثماني (إصدار 2025)",
                    "en": "ANWAR AL-BAYAN: The Uthmanic Script (2025 Edition)"
                },
                "description": {
                    "ar": "دراسة متكاملة للرسم العثماني بأحدث المنهجيات البحثية",
                    "en": "Comprehensive study of Uthmanic script using latest research methodologies"
                },
                "path": {
                    "ar": "books/anwar-al-bayan/ar/content.txt",
                    "en": "books/anwar-al-bayan/en/content.txt"
                },
                "cover": {
                    "ar": "books/anwar-al-bayan/ar/cover-ar.png",
                    "en": "books/anwar-al-bayan/en/cover-en.png"
                },
                "year": 2025,
                "edition": "الطبعة الأولى 2025",
                "category": "الرسم العثماني",
                "keywords": [
                    "رسم",
                    "مصحف",
                    "عثماني",
                    "الرسم العثماني",
                    "المصحف العثماني",
                    "أسرار اللسان",
                    "أنوار البيان",
                    "تدبر القرآن",
                    "المخطوطات الرقمية",
                    "اللغة العربية",
                    "علوم القرآن",
                    "القرآن الكريم",
                    "الفهم العميق",
                    "الدراسات القرآنية",
                    "التفسير",
                    "الخط العربي",
                    "الكتابة القرآنية"
                ]
            },
            {
                "id": "changing-the-concepts",
                "title": {
                    "ar": "تغيير المفاهيم القرآنية (إصدار 2025)",
                    "en": "Changing Quranic Concepts (2025 Edition)"
                },
                "description": {
                    "ar": "رؤية معاصرة لإعادة صياغة المفاهيم القرآنية",
                    "en": "Contemporary vision for redefining Quranic concepts"
                },
                "path": {
                    "ar": "books/changing-the-concepts/ar/content.txt",
                    "en": "books/changing-the-concepts/en/content.txt"
                },
                "cover": {
                    "ar": "books/changing-the-concepts/ar/cover-ar.png",
                    "en": "books/changing-the-concepts/en/cover-en.png"
                },
                "year": 2025,
                "edition": "الطبعة الأولى 2025",
                "category": "المصطلحات القرآنية",
                "keywords": [
                    "مفاهيم",
                    "مصطلحات",
                    "تغيير",
                    "تغيير المفاهيم",
                    "المصطلحات القرآنية",
                    "فقه اللسان القرآني",
                    "التدبر القرآني",
                    "المخطوطات القرآنية الأصلية",
                    "الرقمنة",
                    "الوعي",
                    "الإصلاح والتجديد",
                    "القرآن الكريم كمصدر أوحد وكافٍ",
                    "السنة النبوية ومنهجية التعامل النقدي",
                    "الربوبية والألوهية",
                    "النفس في القرآن",
                    "العبادة (الصلاة، الصيام، الحج، التسبيح)",
                    "القيم القرآنية (العدل، الرحمة، الإحسان)",
                    "التفكير النقدي",
                    "الذكاء والفطرة",
                    "الشرك والتوحيد",
                    "الكون والإنسان",
                    "القيامة واليوم الآخر",
                    "الجنة والنار",
                    "الآيات الكونية",
                    "البيانات كمفهوم قرآني",
                    "المصداق القرآني",
                    "الحروف المقطعة",
                    "النسخ بمعناه الجديد",
                    "الجن والشياطين تصحيح المفاهيم",
                    "الأعداد في القرآن",
                    "القصص القرآني (سورة يوسف كنموذج)",
                    "القتل والقتال تفكيك المفاهيم",
                    "بنو إسرائيل منظور مفاهيمي",
                    "الخلافة الإنسانية",
                    "الزوج والأزواج فهم وظيفي",
                    "الرجال والنساء فهم وظيفي",
                    "القبلة بوصلة الحياة",
                    "المسجد الحرام والمسجد الأقصى رموز الوعي",
                    "الكذب",
                    "الحلال والحرام",
                    "الضحك والبكاء",
                    "الصيد",
                    "حجر",
                    "اليقين",
                    "الذكر",
                    "الدعاء",
                    "الرزق",
                    "الميزان",
                    "الجلد والجلود",
                    "البعوضة كمثل قرآني",
                    "الاستغفار",
                    "العرش والماء",
                    "الخلق والتصوير",
                    "البشر والإنسان",
                    "الخيل والبغال والحمير",
                    "المليكة والملائكة والروح",
                    "الأمة الوسط",
                    "السفه",
                    "الشرق والغرب",
                    "الصراط المستقيم",
                    "اللغة العربية ولسان القرآن",
                    "الفيل",
                    "الرحيم اسم الله",
                    "إحياء البلد",
                    "كلام الله",
                    "رؤية الله",
                    "التسليم",
                    "الساعة",
                    "الموتى والأموات",
                    "الأصنام الفكرية",
                    "الفجر",
                    "القرآن نهر جارٍ",
                    "استشعار معاني الحروف"
                ]
            },
            {
                "id": "contemplation-in-the-mirror",
                "title": {
                    "ar": "التدبر في مرآة الرسوم (إصدار 2025)",
                    "en": "Contemplation in Scripts Mirror (2025 Edition)"
                },
                "description": {
                    "ar": "أحدث تطبيقات الذكاء الاصطناعي في تحليل المخطوطات القرآنية",
                    "en": "Latest AI applications in analyzing Quranic manuscripts"
                },
                "path": {
                    "ar": "books/contemplation-in-the-mirror/ar/content.txt",
                    "en": "books/contemplation-in-the-mirror/en/content.txt"
                },
                "cover": {
                    "ar": "books/contemplation-in-the-mirror/ar/cover-ar.png",
                    "en": "books/contemplation-in-the-mirror/en/cover-en.png"
                },
                "year": 2025,
                "edition": "الطبعة الأولى 2025",
                "category": "التقنية القرآنية",
                "keywords": [
                    "ذكاء اصطناعي",
                    "مخطوطات",
                    "رقمنة",
                    "التدبر في مرآة الرسوم",
                    "المخطوطات الرقمية",
                    "تدبر القرآن",
                    "الرسم العثماني",
                    "تطبيقات عملية للقرآن",
                    "فهم القرآن",
                    "أسرار الرسم العثماني",
                    "نور المخطوطات الرقمية",
                    "أنوار البيان",
                    "جداول المعاني",
                    "ناصر ابن داوود"
                ]
            },
            {
                "id": "digitizing",
                "title": {
                    "ar": "مشروع رقمنة القرآن الكريم (2025)",
                    "en": "Quran Digitization Project (2025)"
                },
                "description": {
                    "ar": "أحدث تقنيات حفظ النص القرآني رقمياً وفق معايير 2025",
                    "en": "State-of-the-art digital preservation of Quranic text (2025 Standards)"
                },
                "path": {
                    "ar": "books/digitizing/ar/content.txt",
                    "en": "books/digitizing/en/content.txt"
                },
                "cover": {
                    "ar": "books/digitizing/ar/cover-ar.png",
                    "en": "books/digitizing/en/cover-en.png"
                },
                "year": 2025,
                "edition": "الطبعة الأولى 2025",
                "category": "الحفظ الرقمي",
                "keywords": [
                    "رقمنة",
                    "تقنية",
                    "حفظ",
                    "رقمنة المخطوطات القرآنية",
                    "تدبر القرآن",
                    "نهضة قرآنية رقمية",
                    "فهم القرآن",
                    "التكنولوجيا والقرآن",
                    "المخطوطة الرقمية الشخصية",
                    "الأصالة والمعاصرة",
                    "التراث العلمي الإسلامي",
                    "الذكاء الاصطناعي والقرآن",
                    "مشروع قرآني",
                    "تحديات رقمنة المخطوطات",
                    "تسويق المشروع القرآني",
                    "مستقبل التدبر القرآني",
                    "نشر التدبرات",
                    "بناء الثقة والشراكات",
                    "التوعية والتثقيف"
                ]
            },
            {
                "id": "modesty",
                "title": {
                    "ar": "الحياء في العصر الرقمي (2025)",
                    "en": "Modesty in Digital Age (2025)"
                },
                "description": {
                    "ar": "دراسة معاصرة لمفهوم الحياء في عصر التكنولوجيا",
                    "en": "Contemporary study of modesty concept in technology era"
                },
                "path": {
                    "ar": "books/modesty/ar/content.txt",
                    "en": "books/modesty/en/content.txt"
                },
                "cover": {
                    "ar": "books/modesty/ar/cover-ar.png",
                    "en": "books/modesty/en/cover-en.png"
                },
                "year": 2025,
                "edition": "الطبعة الأولى 2025",
                "category": "الأخلاق الرقمية",
                "keywords": [
                    "حياء",
                    "أخلاق",
                    "رقمية",
                    "الأخلاق الإسلامية",
                    "الفضائل",
                    "التقوى",
                    "الحياء في الإسلام",
                    "الأدب",
                    "السلوك الرقمي",
                    "الآداب الإسلامية",
                    "التكنولوجيا والأخلاق",
                    "العلاقات الرقمية",
                    "الحشمة",
                    "الستر",
                    "الاحتشام"
                ]
            },
            {
                "id": "names-in-the-holy",
                "title": {
                    "ar": "الأسماء الحسنى في ضوء الدراسات الحديثة (2025)",
                    "en": "Divine Names in Modern Studies (2025)"
                },
                "description": {
                    "ar": "رؤية معاصرة لدلالات الأسماء الإلهية وفق أبحاث 2025",
                    "en": "Contemporary vision of divine names based on 2025 research"
                },
                "path": {
                    "ar": "books/names-in-the-holy/ar/content.txt",
                    "en": "books/names-in-the-holy/en/content.txt"
                },
                "cover": {
                    "ar": "books/names-in-the-holy/ar/cover-ar.png",
                    "en": "books/names-in-the-holy/en/cover-en.png"
                },
                "year": 2025,
                "edition": "الطبعة الأولى 2025",
                "category": "الدراسات الإلهية",
                "keywords": [
                    "أسماء",
                    "إلهية",
                    "دراسات",
                    "الأسماء الحسنى",
                    "الأسماء الحسنى الوظيفية",
                    "التدبير الإلهي",
                    "القرآن الكريم",
                    "دراسة توقيفية",
                    "دلالات الأسماء الحسنى",
                    "الإحصاء",
                    "فهم سنن الكون",
                    "اليقين",
                    "الطمأنينة",
                    "حل المشكلات",
                    "الدعاء",
                    "التوكل",
                    "تطبيق الأسماء الحسنى",
                    "المعرفة بالله",
                    "أسرار الأسماء",
                    "العلاقة بالله",
                    "التأمل في القرآن"
                ]
            },
            {
                "id": "the-jurisprudence",
                "title": {
                    "ar": "فقه اللسان القرآني (إصدار 2025)",
                    "en": "Quranic Linguistics (2025 Edition)"
                },
                "description": {
                    "ar": "دراسة لغوية معاصرة للسان القرآني بأحدث المناهج",
                    "en": "Contemporary linguistic study of Quranic language using latest methodologies"
                },
                "path": {
                    "ar": "books/the-jurisprudence/ar/content.txt",
                    "en": "books/the-jurisprudence/en/content.txt"
                },
                "cover": {
                    "ar": "books/the-jurisprudence/ar/cover-ar.png",
                    "en": "books/the-jurisprudence/en/cover-en.png"
                },
                "year": 2025,
                "edition": "الطبعة الأولى 2025",
                "category": "اللسانيات القرآنية",
                "keywords": [
                    "لسانيات",
                    "لغة",
                    "قرآنية",
                    "فقه اللسان القرآني",
                    "فهم النص القرآني",
                    "المخطوطات القرآنية",
                    "الرسوم القرآنية",
                    "التدبر",
                    "المخطوطات الرقمية",
                    "المفاهيم الجديدة",
                    "التدبر التفاعلي",
                    "رقمنة المخطوطات الأصلية",
                    "المصاحف العثمانية",
                    "فهم القرآن",
                    "تطبيق القرآن",
                    "قواعد اللسان العربي القرآني",
                    "استنباط القواعد من النص القرآني",
                    "الشواهد من المخطوطات الأصلية",
                    "دلالات الحروف",
                    "سبعا من المثاني",
                    "الأزواج",
                    "الترادف",
                    "المنهج اللفظي",
                    "المحكم والمتشابه",
                    "السياق اللساني",
                    "المصطلح القرآني",
                    "الناسخ والمنسوخ",
                    "تجديد الخطاب الديني",
                    "الواقع المعاصر",
                    "الكتابة القرآنية",
                    "القرآن الكريم"
                ]
            },
            {
                "id": "editing-the-quranic-terminology-tome1",
                "title": {
                    "ar": "تحرير المصطلح القرآني - المجلد الأول (2025)",
                    "en": "Quranic Terminology - Volume 1 (2025)"
                },
                "description": {
                    "ar": "أحدث دراسة في المصطلحات القرآنية (إصدار 2025)",
                    "en": "Cutting-edge study in Quranic terminology (2025 Release)"
                },
                "path": {
                    "ar": "books/editing-the-quranic-terminology-tome1/ar/content.txt",
                    "en": "books/editing-the-quranic-terminology-tome1/en/content.txt"
                },
                "cover": {
                    "ar": "books/editing-the-quranic-terminology-tome1/ar/cover-ar.png",
                    "en": "books/editing-the-quranic-terminology-tome1/en/cover-en.png"
                },
                "year": 2025,
                "edition": "الطبعة الأولى 2025",
                "category": "المصطلحات القرآنية",
                "keywords": [
                    "مصطلحات",
                    "جزء1",
                    "تحرير",
                    "تغيير المفاهيم",
                    "المصطلحات القرآنية",
                    "فقه اللسان القرآني",
                    "التدبر القرآني",
                    "المخطوطات القرآنية الأصلية",
                    "الرقمنة",
                    "الوعي",
                    "الإصلاح والتجديد",
                    "القرآن الكريم كمصدر أوحد وكافٍ",
                    "السنة النبوية ومنهجية التعامل النقدي",
                    "الربوبية والألوهية",
                    "النفس في القرآن",
                    "العبادة (الصلاة، الصيام، الحج، التسبيح)",
                    "القيم القرآنية (العدل، الرحمة، الإحسان)",
                    "التفكير النقدي",
                    "الذكاء والفطرة",
                    "الشرك والتوحيد",
                    "الكون والإنسان",
                    "القيامة واليوم الآخر",
                    "الجنة والنار",
                    "الآيات الكونية",
                    "البيانات كمفهوم قرآني",
                    "المصداق القرآني",
                    "الحروف المقطعة",
                    "النسخ بمعناه الجديد",
                    "الجن والشياطين تصحيح المفاهيم",
                    "الأعداد في القرآن",
                    "القصص القرآني (سورة يوسف كنموذج)",
                    "القتل والقتال تفكيك المفاهيم",
                    "بنو إسرائيل منظور مفاهيمي",
                    "الخلافة الإنسانية",
                    "الزوج والأزواج فهم وظيفي",
                    "الرجال والنساء فهم وظيفي",
                    "القبلة بوصلة الحياة",
                    "المسجد الحرام والمسجد الأقصى رموز الوعي",
                    "الكذب",
                    "الحلال والحرام",
                    "الضحك والبكاء",
                    "الصيد",
                    "حجر",
                    "اليقين",
                    "الذكر",
                    "الدعاء",
                    "الرزق",
                    "الميزان",
                    "الجلد والجلود",
                    "البعوضة كمثل قرآني",
                    "الاستغفار",
                    "العرش والماء",
                    "الخلق والتصوير",
                    "البشر والإنسان",
                    "الخيل والبغال والحمير",
                    "المليكة والملائكة والروح",
                    "الأمة الوسط",
                    "السفه",
                    "الشرق والغرب",
                    "الصراط المستقيم",
                    "اللغة العربية ولسان القرآن",
                    "الفيل",
                    "الرحيم اسم الله",
                    "إحياء البلد",
                    "كلام الله",
                    "رؤية الله",
                    "التسليم",
                    "الساعة",
                    "الموتى والأموات",
                    "الأصنام الفكرية",
                    "الفجر",
                    "القرآن نهر جارٍ",
                    "استشعار معاني الحروف"
                ]
            },
            {
                "id": "editing-the-quranic-terminology-tome2",
                "title": {
                    "ar": "تحرير المصطلح القرآني - المجلد الثاني (2025)",
                    "en": "Quranic Terminology - Volume 2 (2025)"
                },
                "description": {
                    "ar": "تكملة لأحدث دراسة في المصطلحات القرآنية (2025)",
                    "en": "Continuation of advanced Quranic terminology study (2025)"
                },
                "path": {
                    "ar": "books/editing-the-quranic-terminology-tome2/ar/content.txt",
                    "en": "books/editing-the-quranic-terminology-tome2/en/content.txt"
                },
                "cover": {
                    "ar": "books/editing-the-quranic-terminology-tome2/ar/cover-ar.png",
                    "en": "books/editing-the-quranic-terminology-tome2/en/cover-en.png"
                },
                "year": 2025,
                "edition": "الطبعة الأولى 2025",
                "category": "المصطلحات القرآنية",
                "keywords": [
                    "مصطلحات",
                    "جزء2",
                    "تحرير",
                    "تغيير المفاهيم",
                    "المصطلحات القرآنية",
                    "فقه اللسان القرآني",
                    "التدبر القرآني",
                    "المخطوطات القرآنية الأصلية",
                    "الرقمنة",
                    "الوعي",
                    "الإصلاح والتجديد",
                    "القرآن الكريم كمصدر أوحد وكافٍ",
                    "السنة النبوية ومنهجية التعامل النقدي",
                    "الربوبية والألوهية",
                    "النفس في القرآن",
                    "العبادة (الصلاة، الصيام، الحج، التسبيح)",
                    "القيم القرآنية (العدل، الرحمة، الإحسان)",
                    "التفكير النقدي",
                    "الذكاء والفطرة",
                    "الشرك والتوحيد",
                    "الكون والإنسان",
                    "القيامة واليوم الآخر",
                    "الجنة والنار",
                    "الآيات الكونية",
                    "البيانات كمفهوم قرآني",
                    "المصداق القرآني",
                    "الحروف المقطعة",
                    "النسخ بمعناه الجديد",
                    "الجن والشياطين تصحيح المفاهيم",
                    "الأعداد في القرآن",
                    "القصص القرآني (سورة يوسف كنموذج)",
                    "القتل والقتال تفكيك المفاهيم",
                    "بنو إسرائيل منظور مفاهيمي",
                    "الخلافة الإنسانية",
                    "الزوج والأزواج فهم وظيفي",
                    "الرجال والنساء فهم وظيفي",
                    "القبلة بوصلة الحياة",
                    "المسجد الحرام والمسجد الأقصى رموز الوعي",
                    "الكذب",
                    "الحلال والحرام",
                    "الضحك والبكاء",
                    "الصيد",
                    "حجر",
                    "اليقين",
                    "الذكر",
                    "الدعاء",
                    "الرزق",
                    "الميزان",
                    "الجلد والجلود",
                    "البعوضة كمثل قرآني",
                    "الاستغفار",
                    "العرش والماء",
                    "الخلق والتصوير",
                    "البشر والإنسان",
                    "الخيل والبغال والحمير",
                    "المليكة والملائكة والروح",
                    "الأمة الوسط",
                    "السفه",
                    "الشرق والغرب",
                    "الصراط المستقيم",
                    "اللغة العربية ولسان القرآن",
                    "الفيل",
                    "الرحيم اسم الله",
                    "إحياء البلد",
                    "كلام الله",
                    "رؤية الله",
                    "التسليم",
                    "الساعة",
                    "الموتى والأموات",
                    "الأصنام الفكرية",
                    "الفجر",
                    "القرآن نهر جارٍ",
                    "استشعار معاني الحروف"
                ]
            },
            {
                "id": "editing-the-quranic-terminology-tome3",
                "title": {
                    "ar": "تحرير المصطلح القرآني - المجلد الثالث (2025)",
                    "en": "Quranic Terminology - Volume 3 (2025)"
                },
                "description": {
                    "ar": "الجزء الأخير من سلسلة الدراسات المصطلحية (إصدار 2025)",
                    "en": "Final part of terminology studies series (2025 Edition)"
                },
                "path": {
                    "ar": "books/editing-the-quranic-terminology-tome3/ar/content.txt",
                    "en": "books/editing-the-quranic-terminology-tome3/en/content.txt"
                },
                "cover": {
                    "ar": "books/editing-the-quranic-terminology-tome3/ar/cover-ar.png",
                    "en": "books/editing-the-quranic-terminology-tome3/en/cover-en.png"
                },
                "year": 2025,
                "edition": "الطبعة الأولى 2025",
                "category": "المصطلحات القرآنية",
                "keywords": [
                    "مصطلحات",
                    "جزء3",
                    "تحرير",
                    "تغيير المفاهيم",
                    "المصطلحات القرآنية",
                    "فقه اللسان القرآني",
                    "التدبر القرآني",
                    "المخطوطات القرآنية الأصلية",
                    "الرقمنة",
                    "الوعي",
                    "الإصلاح والتجديد",
                    "القرآن الكريم كمصدر أوحد وكافٍ",
                    "السنة النبوية ومنهجية التعامل النقدي",
                    "الربوبية والألوهية",
                    "النفس في القرآن",
                    "العبادة (الصلاة، الصيام، الحج، التسبيح)",
                    "القيم القرآنية (العدل، الرحمة، الإحسان)",
                    "التفكير النقدي",
                    "الذكاء والفطرة",
                    "الشرك والتوحيد",
                    "الكون والإنسان",
                    "القيامة واليوم الآخر",
                    "الجنة والنار",
                    "الآيات الكونية",
                    "البيانات كمفهوم قرآني",
                    "المصداق القرآني",
                    "الحروف المقطعة",
                    "النسخ بمعناه الجديد",
                    "الجن والشياطين تصحيح المفاهيم",
                    "الأعداد في القرآن",
                    "القصص القرآني (سورة يوسف كنموذج)",
                    "القتل والقتال تفكيك المفاهيم",
                    "بنو إسرائيل منظور مفاهيمي",
                    "الخلافة الإنسانية",
                    "الزوج والأزواج فهم وظيفي",
                    "الرجال والنساء فهم وظيفي",
                    "القبلة بوصلة الحياة",
                    "المسجد الحرام والمسجد الأقصى رموز الوعي",
                    "الكذب",
                    "الحلال والحرام",
                    "الضحك والبكاء",
                    "الصيد",
                    "حجر",
                    "اليقين",
                    "الذكر",
                    "الدعاء",
                    "الرزق",
                    "الميزان",
                    "الجلد والجلود",
                    "البعوضة كمثل قرآني",
                    "الاستغفار",
                    "العرش والماء",
                    "الخلق والتصوير",
                    "البشر والإنسان",
                    "الخيل والبغال والحمير",
                    "المليكة والملائكة والروح",
                    "الأمة الوسط",
                    "السفه",
                    "الشرق والغرب",
                    "الصراط المستقيم",
                    "اللغة العربية ولسان القرآن",
                    "الفيل",
                    "الرحيم اسم الله",
                    "إحياء البلد",
                    "كلام الله",
                    "رؤية الله",
                    "التسليم",
                    "الساعة",
                    "الموتى والأموات",
                    "الأصنام الفكرية",
                    "الفجر",
                    "القرآن نهر جارٍ",
                    "استشعار معاني الحروف"
                ]
            },
            {
                "id": "malakoot",
                "title": {
                    "ar": "ملكوت السماوات والأرض (رؤية 2025)",
                    "en": "Kingdom of Heavens and Earth (2025 Vision)"
                },
                "description": {
                    "ar": "أحدث دراسة في الإيمان بالغيب وفق الاكتشافات المعاصرة",
                    "en": "Latest study on unseen belief based on modern discoveries"
                },
                "path": {
                    "ar": "books/malakoot/ar/content.txt",
                    "en": "books/malakoot/en/content.txt"
                },
                "cover": {
                    "ar": "books/malakoot/ar/cover-ar.png",
                    "en": "books/malakoot/en/cover-en.png"
                },
                "year": 2025,
                "edition": "الطبعة الأولى 2025",
                "category": "الإيمان والعلم",
                "keywords": [
                    "ملكوت",
                    "إيمان",
                    "علم",
                    "اليقين",
                    "ملكوت السماوات والأرض",
                    "برهان",
                    "رؤية الحقيقة",
                    "القرآن",
                    "الحقائق العلمية",
                    "الوحي",
                    "الفطرة",
                    "الكون",
                    "الخلق",
                    "الخالق",
                    "الأرض المسطحة",
                    "الأرض الثابتة",
                    "التفكر",
                    "التدبر",
                    "نظريات إسلامية",
                    "شكل الكون",
                    "الشمس",
                    "القمر",
                    "الكواكب",
                    "علم الفلك",
                    "ناصر ابن داوود",
                    "ناصر بن داود التدبر في مرآة الرسوم"
                ]
            }
        ],
        "metadata": {
            "year": 2025,
            "total_books": 20,
            "total_arabic": 10,
            "total_english": 10,
            "release_date": "2025-08-15",
            "categories": [
                "التدبر القرآني",
                "الرسم العثماني",
                "المصطلحات القرآنية",
                "التقنية القرآنية",
                "الحفظ الرقمي",
                "الأخلاق الرقمية",
                "الدراسات الإلهية",
                "اللسانيات القرآنية",
                "الإيمان والعلم"
            ],
            "features": {
                "all_new": true,
                "latest_research": true,
                "digital_editions": true,
                "multilingual": true,
                "searchable": true,
                "indexed": true
            },
            "author": {
                "name": "ناصر ابن داوود",
                "bio": "باحث إسلامي متخصص في علوم القرآن والتدبر، مهندس متخصص في الرقمنة والحفظ الرقمي للمخطوطات القرآنية",
                "website": "https://nasser-ibn-dawood.com"
            }
        }
    };

    // Update last update time
    function updateLastUpdateTime() {
        const now = new Date();
        const options = { 
            weekday: 'long', 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        };
        document.getElementById('last-update').textContent = now.toLocaleDateString('ar-SA', options);
    }

    // Render books dynamically
    function renderBooks(data) {
        const bookGrid = document.getElementById('book-grid');
        const newBookGrid = document.getElementById('new-book-grid');
        let bookCount = 0;
        let newBookCount = 0;

        data.books.forEach((book, index) => {
            // Arabic version
            const arCard = document.createElement('div');
            arCard.className = 'book-card';
            arCard.dataset.lang = 'ar';
            arCard.id = `book-${index * 2 + 1}`;
            const isNew = book.year === 2025 && ['editing-the-quranic-terminology-tome1', 'editing-the-quranic-terminology-tome2', 'editing-the-quranic-terminology-tome3'].includes(book.id);
            arCard.innerHTML = `
                <div class="book-cover">
                    ${isNew ? '<span class="new-badge-card">جديد</span>' : ''}
                    <img data-src="${book.cover.ar}" alt="${book.title.ar}" loading="lazy" width="250" height="350">
                </div>
                <div class="book-info">
                    <h2>${book.title.ar}</h2>
                    <p class="book-meta">تأليف: ناصر ابن داوود</p>
                    <p class="book-desc">${book.description.ar}</p>
                    <div class="book-actions">
                        <a href="${book.path.ar}" class="btn">النسخة العربية</a>
                    </div>
                </div>
            `;
            // English version
            const enCard = document.createElement('div');
            enCard.className = 'book-card';
            enCard.dataset.lang = 'en';
            enCard.id = `book-${index * 2 + 2}`;
            enCard.innerHTML = `
                <div class="book-cover">
                    ${isNew ? '<span class="new-badge-card">NEW</span>' : ''}
                    <img data-src="${book.cover.en}" alt="${book.title.en}" loading="lazy" width="250" height="350">
                </div>
                <div class="book-info">
                    <h2>${book.title.en}</h2>
                    <p class="book-meta">By: Nasser Ibn Dawood</p>
                    <p class="book-desc">${book.description.en}</p>
                    <div class="book-actions">
                        <a href="${book.path.en}" class="btn">English Version</a>
                    </div>
                </div>
            `;
            
            // Place in appropriate grid
            if (isNew) {
                newBookGrid.appendChild(arCard);
                newBookGrid.appendChild(enCard);
                newBookCount += 2;
            } else {
                bookGrid.appendChild(arCard);
                bookGrid.appendChild(enCard);
            }
            bookCount += 2;
        });

        document.getElementById('total-books-count').textContent = bookCount;
        document.getElementById('new-books-count').textContent = newBookCount;
    }

    // Lazy load images
    function setupLazyLoading() {
        const images = document.querySelectorAll('.book-cover img');
        const observer = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    img.src = img.dataset.src;
                    observer.unobserve(img);
                }
            });
        }, { rootMargin: '0px 0px 100px 0px' });
        images.forEach(img => observer.observe(img));
    }

    // Fuzzy search with diacritic removal
    function fuzzySearch(text, searchTerm) {
        const removeDiacritics = (str) => {
            return str.normalize('NFKD').replace(/[\u064B-\u065F]/g, '');
        };
        const cleanText = removeDiacritics(text.toLowerCase());
        const cleanSearchTerm = removeDiacritics(searchTerm.toLowerCase());
        let searchIndex = 0;
        for (let i = 0; i < cleanText.length; i++) {
            if (cleanText[i] === cleanSearchTerm[searchIndex]) {
                searchIndex++;
                if (searchIndex === cleanSearchTerm.length) return true;
            }
        }
        return false;
    }

    // Highlight search matches
    function highlightText(text, searchTerm) {
        if (!searchTerm) return text;
        const regex = new RegExp(`(${searchTerm})`, 'gi');
        return text.replace(regex, '<span class="highlight">$1</span>');
    }

    // Debounce function
    function debounce(func, wait, immediate) {
        let timeout;
        return function() {
            const context = this, args = arguments;
            const later = function() {
                timeout = null;
                if (!immediate) func.apply(context, args);
            };
            const callNow = immediate && !timeout;
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
            if (callNow) func.apply(context, args);
        };
    }

    // Setup search functionality
    function setupSearch(data) {
        const searchInput = document.getElementById('book-search');
        const suggestionsContainer = document.getElementById('search-suggestions');
        const searchInfo = document.getElementById('search-info');
        const searchTermDisplay = document.getElementById('search-term-display');
        const searchResultsCount = document.getElementById('search-results-count');
        const noResultsMsg = document.getElementById('no-results');
        const bookCards = Array.from(document.querySelectorAll('#book-grid .book-card, #new-book-grid .book-card'));

        const performSearch = debounce(function() {
            const searchTerm = this.value.trim();
            searchTermDisplay.textContent = searchTerm;
            searchTermDisplay.innerHTML = highlightText(searchTerm, searchTerm);
            
            if (searchTerm === '') {
                suggestionsContainer.style.display = 'none';
                bookCards.forEach(card => card.style.display = 'block');
                searchInfo.style.display = 'none';
                noResultsMsg.style.display = 'none';
                return;
            }
            
            const suggestions = [];
            let resultsCount = 0;
            
            bookCards.forEach(card => {
                const bookId = card.id.split('-')[1];
                const book = data.books.find(b => card.id === `book-${data.books.indexOf(b) * 2 + 1}` || card.id === `book-${data.books.indexOf(b) * 2 + 2}`);
                const lang = card.dataset.lang;
                const title = book.title[lang];
                const author = lang === 'ar' ? 'تأليف: ناصر ابن داوود' : 'By: Nasser Ibn Dawood';
                const desc = book.description[lang];
                const keywords = book.keywords.join(' ');
                
                const matches = fuzzySearch(title, searchTerm) || 
                              fuzzySearch(author, searchTerm) ||
                              fuzzySearch(desc, searchTerm) ||
                              fuzzySearch(keywords, searchTerm);
                
                if (matches) {
                    card.style.display = 'block';
                    resultsCount++;
                    
                    if (fuzzySearch(title, searchTerm)) {
                        card.querySelector('h2').innerHTML = highlightText(title, searchTerm);
                    }
                    if (fuzzySearch(author, searchTerm)) {
                        card.querySelector('.book-meta').innerHTML = highlightText(author, searchTerm);
                    }
                    if (fuzzySearch(desc, searchTerm)) {
                        card.querySelector('.book-desc').innerHTML = highlightText(desc, searchTerm);
                    }
                    
                    suggestions.push({
                        title: title,
                        author: author,
                        id: card.id,
                        searchTerm: searchTerm
                    });
                } else {
                    card.style.display = 'none';
                    card.querySelector('h2').innerHTML = title;
                    card.querySelector('.book-meta').innerHTML = author;
                    card.querySelector('.book-desc').innerHTML = desc;
                }
            });
            
            searchResultsCount.textContent = resultsCount;
            searchInfo.style.display = 'block';
            
            if (resultsCount === 0) {
                noResultsMsg.style.display = 'block';
            } else {
                noResultsMsg.style.display = 'none';
            }
            
            if (suggestions.length > 0) {
                suggestionsContainer.innerHTML = suggestions.map(book => `
                    <div class="suggestion-item" data-id="${book.id}">
                        <div class="suggestion-title">${highlightText(book.title, book.searchTerm)}</div>
                        <div class="suggestion-author">${highlightText(book.author, book.searchTerm)}</div>
                    </div>
                `).join('');
                suggestionsContainer.style.display = 'block';
            } else {
                suggestionsContainer.innerHTML = '<div class="suggestion-item">لا توجد نتائج</div>';
                suggestionsContainer.style.display = 'block';
            }
        }, 300);
        
        searchInput.addEventListener('input', performSearch);
        
        document.addEventListener('click', (e) => {
            if (!suggestionsContainer.contains(e.target) && e.target !== searchInput) {
                suggestionsContainer.style.display = 'none';
            }
        });
        
        suggestionsContainer.addEventListener('click', (e) => {
            const suggestion = e.target.closest('.suggestion-item');
            if (suggestion) {
                const bookId = suggestion.dataset.id;
                if (bookId) {
                    suggestionsContainer.style.display = 'none';
                    const bookCard = document.getElementById(bookId);
                    if (bookCard) {
                        bookCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        bookCard.style.boxShadow = '0 0 0 3px rgba(41, 128, 185, 0.5)';
                        setTimeout(() => { 
                            bookCard.style.boxShadow = ''; 
                        }, 2000);
                    }
                }
            }
        });
        
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                performSearch.call(searchInput);
            }
        });
    }

    // Setup filter buttons
    function setupFilterButtons() {
        document.querySelectorAll('.filter-buttons button').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelector('.filter-buttons .active').classList.remove('active');
                button.classList.add('active');
                const filter = button.dataset.filter;
                document.querySelectorAll('#book-grid .book-card').forEach(card => {
                    card.style.display = filter === 'all' || card.dataset.lang === filter ? 'block' : 'none';
                });
            });
        });
    }

    // Setup new books filter
    function setupNewBooksFilter() {
        document.querySelectorAll('.new-filter-buttons button').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelector('.new-filter-buttons .active').classList.remove('active');
                button.classList.add('active');
                const filter = button.dataset.filter;
                document.querySelectorAll('#new-book-grid .book-card').forEach(card => {
                    card.style.display = filter === 'all' || card.dataset.lang === filter ? 'block' : 'none';
                });
            });
        });
    }

    // Fix book paths
    function fixBookPaths() {
        document.querySelectorAll('.book-actions a[href^="books/"]').forEach(link => {
            const correctedPath = link.getAttribute('href').replace(/ /g, '-').toLowerCase();
            link.setAttribute('href', correctedPath);
        });
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
        // In production, replace with fetch:
        // fetch('index.json')
        //     .then(response => {
        //         if (!response.ok) throw new Error('Failed to load book data');
        //         return response.json();
        //     })
        //     .then(data => {
        //         renderBooks(data);
        //         setupSearch(data);
        //         setupLazyLoading();
        //         updateLastUpdateTime();
        //         setupFilterButtons();
        //         setupNewBooksFilter();
        //         fixBookPaths();
        //     })
        //     .catch(error => {
        //         console.error('Error fetching index.json:', error);
        //         document.getElementById('error-message').style.display = 'block';
        //     });
        
        renderBooks(booksData);
        setupSearch(booksData);
        setupLazyLoading();
        updateLastUpdateTime();
        setupFilterButtons();
        setupNewBooksFilter();
        fixBookPaths();

        setInterval(() => {
            updateLastUpdateTime();
        }, 3600000);
    });
    </script>
</body>
</html>
