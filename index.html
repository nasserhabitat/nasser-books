<DOCUMENT filename="index (91).html">

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙƒØªØ¨Ø© Ù†Ø§ØµØ± Ø§Ø¨Ù† Ø¯Ø§ÙˆÙˆØ¯</title>
    <style>
        /* Ø£Ø¶Ù Ø£Ù†Ù…Ø§Ø· CSS Ù‡Ù†Ø§ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø± */
    </style>
</head>
<body>

    ğŸ¤– Ù…Ù†ØµØ© Ù…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ - Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: <span id="last-update"></span>

    <!-- Ø¨Ø§Ù‚ÙŠ Ù…Ø­ØªÙˆÙ‰ HTML Ù‡Ù†Ø§ØŒ Ù…Ø«Ù„ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… ÙˆØ§Ù„Ø£Ù‚Ø³Ø§Ù… -->

    <script>
        let libraryBooks = {
            "books": [
                {
                    "id": "conscious-contemplation",
                    "title_ar": "Ù†Ø­Ùˆ ØªØ¯Ø¨Ø± ÙˆØ§Ø¹Ù",
                    "title_en": "Towards Conscious Contemplation",
                    "description_ar": "ÙƒØªØ§Ø¨ ÙŠØ´Ø±Ø­ Ù…Ù†Ù‡Ø¬ÙŠØ© Ø§Ù„ØªØ¯Ø¨Ø± Ø§Ù„Ø¹Ù…ÙŠÙ‚ Ù„Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… ÙˆØªØ·Ø¨ÙŠÙ‚Ø§ØªÙ‡ Ø§Ù„Ø¹ØµØ±ÙŠØ©",
                    "description_en": "A practical guide to deep understanding and applying the Noble Quran in the modern era",
                    "category": "quranic_studies",
                    "pages_ar": 91,
                    "pages_en": 126,
                    "links": {
                        "ar": {
                            "docx": "https://drive.google.com/uc?export=download&id=17AkqVDGa9GOoGEpCHmk1yfQ9t9uIgUV2",
                            "html": "https://drive.google.com/uc?export=download&id=1CjD4C5WZBg6Nl7JTHMdvrgMbHI1GRVem",
                            "pdf": "books/conscious-contemplation/ar/content.pdf",
                            "pdf_external": "https://drive.google.com/uc?export=download&id=1rMSGwIltsrPSjT4RLoX8ds21MyB633i7",
                            "text": "books/conscious-contemplation/ar/content.txt",
                            "text_external": "https://drive.google.com/uc?export=download&id=1ZjCEi5V3dye2T0fwpAExfnM9haDKhnQF",
                            "archive_text": "https://archive.org/stream/20250529_20250529_2132/%D9%86%D8%AD%D9%88%20%D8%AA%D8%AF%D8%A8%D8%B1%D9%8D%20%D9%88%D8%A7%D8%B9%D9%8D%20%D8%AF%D9%84%D9%8A%D9%84%20%D8%B9%D9%85%D9%84%D9%8A%20%D9%84%D9%81%D9%87%D9%85%20%D9%88%D8%AA%D8%B7%D8%A8%D9%8A%D9%82%20%D8%A7%D9%84%D9%82%D8%B1%D8%A2%D9%86%20%D8%A7%D9%84%D9%83%D8%B1%D9%8A%D9%85%20%D9%81%D9%8A%20%D8%A7%D9%84%D8%B9%D8%B5%D8%B1%20%D8%A7%D9%84%D8%AD%D8%AF%D9%8A%D8%AB_djvu.txt",
                            "archive_pdf": "https://dn720702.ca.archive.org/0/items/20250529_20250529_2132/%D9%86%D8%AD%D9%88%20%D8%AA%D8%AF%D8%A8%D8%B1%D9%8D%20%D9%88%D8%A7%D8%B9%D9%8D%20%D8%AF%D9%84%D9%8A%D9%84%20%D8%B9%D9%85%D9%84%D9%8A%20%D9%84%D9%81%D9%87%D9%85%20%D9%88%D8%AA%D8%B7%D8%A8%D9%8A%D9%82%20%D8%A7%D9%84%D9%82%D8%B1%D8%A2%D9%86%20%D8%A7%D9%84%D9%83%D8%B1%D9%8A%D9%85%20%D9%81%D9%8A%20%D8%A7%D9%84%D8%B9%D8%B5%D8%B1%20%D8%A7%D9%84%D8%AD%D8%AF%D9%8A%D8%AB.pdf",
                            "cover": "books/conscious-contemplation/ar/cover-ar.png"
                        },
                        "en": {
                            "docx": "https://drive.google.com/uc?export=download&id=18FP0NmPM1CHSCZs0UDLnLBGSrqfEJWlX",
                            "html": "https://drive.google.com/uc?export=download&id=11gaZUgs7DkUBe_8OABu1remHgaEfZmnn",
                            "pdf": "books/conscious-contemplation/en/content.pdf",
                            "pdf_external": "https://drive.google.com/uc?export=download&id=1yKPdEMoAMHXLmKlhaSVhy61tjWoVEVbv",
                            "text": "books/conscious-contemplation/en/content.txt",
                            "text_external": "https://drive.google.com/uc?export=download&id=1sWN_QZ-Ovmam3g2Y-I_a1OXkV4wFiqYb",
                            "archive_text": "https://archive.org/stream/towards-conscious-contemplation-a-practical-guide-to-understanding-and-applying-/TOWARDS%20CONSCIOUS%20CONTEMPLATION%20%20%20A%20PRACTICAL%20GUIDE%20TO%20UNDERSTANDING%20AND%20APPLYING%20THE%20NOBLE%20QUR%27AN%20IN%20THE%20MODERN%20ERA_djvu.txt",
                            "archive_pdf": "https://ia800602.us.archive.org/9/items/towards-conscious-contemplation-a-practical-guide-to-understanding-and-applying-/TOWARDS%20CONSCIOUS%20CONTEMPLATION%20%20%20A%20PRACTICAL%20GUIDE%20TO%20UNDERSTANDING%20AND%20APPLYING%20THE%20NOBLE%20QUR%27AN%20IN%20THE%20MODERN%20ERA.pdf",
                            "cover": "books/conscious-contemplation/en/cover-en.png"
                        },
                        "page": {
                            "ar": "books/conscious-contemplation/ar/index.html",
                            "en": "books/conscious-contemplation/en/index.html"
                        }
                    },
                    "cover": {
                        "ar": "https://nasserhabitat.github.io/nasser-books/books/conscious-contemplation/ar/cover-ar.png",
                        "en": "https://nasserhabitat.github.io/nasser-books/books/conscious-contemplation/en/cover-en.png"
                    },
                    "ai_access": {
                        "structured_data": true,
                        "api_accessible": true,
                        "content_analysis": true,
                        "formats": ["html", "pdf", "txt"],
                        "topics": ["ØªØ¯Ø¨Ø± Ø§Ù„Ù‚Ø±Ø¢Ù†", "ÙÙ‡Ù… Ø§Ù„Ù‚Ø±Ø¢Ù†", "ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù‚Ø±Ø¢Ù†", "Ù…Ù†Ù‡Ø¬ÙŠØ© Ø§Ù„ØªØ¯Ø¨Ø±", "Ø§Ù„Ù‚Ø±Ø¢Ù† ÙÙŠ Ø§Ù„Ø¹ØµØ± Ø§Ù„Ø­Ø¯ÙŠØ«", "Ù†ÙˆØ± Ø§Ù„Ø¹Ù‚Ù„", "Ø±Ù‚Ù…Ù†Ø© Ø§Ù„Ù…Ø®Ø·ÙˆØ·Ø§Øª Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠØ©", "Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¹Ø«Ù…Ø§Ù†ÙŠ", "Ø§Ù„Ù…Ø®Ø·ÙˆØ·Ø§Øª Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠØ© Ø§Ù„Ø£ØµÙ„ÙŠØ©", "Ù…Ù†Ù‡Ø¬ Ø­ÙŠØ§Ø©", "Ø§Ù„ÙÙ‡Ù… Ø§Ù„ÙˆØ§Ø¹ÙŠ Ù„Ù„Ù‚Ø±Ø¢Ù†", "Ø¢ÙŠØ§Øª Ø§Ù„Ù‚Ø±Ø¢Ù†", "Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…", "ØªØ¯Ø¨Ø± Ø¹Ù…Ù„ÙŠ", "Ù†Ø§ØµØ± Ø§Ø¨Ù† Ø¯Ø§ÙˆÙˆØ¯"]
                    },
                    "content_ar": null,
                    "content_en": null,
                    "publishedDate": "2025-01-22T12:00:00Z"
                },
                {
                    "id": "anwar-al-bayan",
                    "title_ar": "Ø£Ù†ÙˆØ§Ø± Ø§Ù„Ø¨ÙŠØ§Ù† ÙÙŠ Ø±Ø³Ù… Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø¹Ø«Ù…Ø§Ù†ÙŠ: Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø£Ø³Ø±Ø§Ø± Ø§Ù„Ù„Ø³Ø§Ù†",
                    "title_en": "Anwar Al-Bayan in the Drawing of the Ottoman Quran: Unveiling the Secrets of the Tongue",
                    "description_ar": "Ø¯Ø±Ø§Ø³Ø© Ø¹Ù„Ù…ÙŠØ© Ù…ØªØ¹Ù…Ù‚Ø© Ù„Ù„Ø±Ø³Ù… Ø§Ù„Ø¹Ø«Ù…Ø§Ù†ÙŠ ÙˆØ£Ø³Ø±Ø§Ø±Ù‡ Ø§Ù„Ù„ØºÙˆÙŠØ© ÙÙŠ ÙÙ‡Ù… Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…",
                    "description_en": "A scientific study revealing the linguistic secrets of the Ottoman Quranic script",
                    "category": "quranic_studies",
                    "pages_ar": 161,
                    "pages_en": 215,
                    "links": {
                        "ar": {
                            "docx": "https://drive.google.com/uc?export=download&id=1VjEJEjjrJbM7glhR2lHEsqB1L94t2XCu",
                            "html": "https://drive.google.com/uc?export=download&id=1OuuQzbqrCW9blAvWc2AIpHdM9sl4bYUB",
                            "pdf": "books/anwar-al-bayan/ar/content.pdf",
                            "pdf_external": "https://drive.google.com/uc?export=download&id=1OuuQzbqrCW9blAvWc2AIpHdM9sl4bYUB",
                            "text": "books/anwar-al-bayan/ar/content.txt",
                            "text_external": "https://drive.google.com/uc?export=download&id=1O0uafxgb-EXpmiOZaNnLEx73okvilKZl",
                            "archive_text": "https://archive.org/stream/20250529_20250529_2033/%D8%A3%D9%86%D9%88%D8%A7%D8%B1%20%D8%A7%D9%84%D8%A8%D9%8A%D8%A7%D9%86%20%D9%81%D9%8A%20%D8%B1%D8%B3%D9%85%20%D8%A7%D9%84%D9%85%D8%B5%D8%AD%D9%81%20%D8%A7%D9%84%D8%B9%D8%AB%D9%85%D8%A7%D9%86%D9%8A%20%D8%A7%D9%84%D9%83%D8%B4%D9%81%20%D8%B9%D9%86%20%D8%A3%D8%B3%D8%B1%D8%A7%D8%B1%20%D8%A7%D9%84%D9%84%D8%B3%D8%A7%D9%86_djvu.txt",
                            "archive_pdf": "https://dn721701.ca.archive.org/0/items/20250529_20250529_2033/%D8%A3%D9%86%D9%88%D8%A7%D8%B1%20%D8%A7%D9%84%D8%A8%D9%8A%D8%A7%D9%86%20%D9%81%D9%8A%20%D8%B1%D8%B3%D9%85%20%D8%A7%D9%84%D9%85%D8%B5%D8%AD%D9%81%20%D8%A7%D9%84%D8%B9%D8%AB%D9%85%D8%A7%D9%86%D9%8A%20%D8%A7%D9%84%D9%83%D8%B4%D9%81%20%D8%B9%D9%86%20%D8%A3%D8%B3%D8%B1%D8%A7%D8%B1%20%D8%A7%D9%84%D9%84%D8%B3%D8%A7%D9%86.pdf",
                            "cover": "books/anwar-al-bayan/ar/cover-ar.png"
                        },
                        "en": {
                            "docx": "https://drive.google.com/uc?export=download&id=1TVOxURf1EI8Oq774aUANI7WRqbg5MbOi",
                            "html": "https://drive.google.com/uc?export=download&id=1s0x6gR0p7zfHuQIN7C8mpYT82NyHysEX",
                            "pdf": "books/anwar-al-bayan/en/content.pdf",
                            "pdf_external": "https://drive.google.com/uc?export=download&id=1kyDrHDpYAWA1G0KE8Ow5e5VIk-lbM6zZ",
                            "text": "books/anwar-al-bayan/en/content.txt",
                            "text_external": "https://drive.google.com/uc?export=download&id=1vo44VX03M_ZR-ISriWgqAteOrvG8HMu2",
                            "archive_text": "https://archive.org/stream/anwar-al-bayan-in-the-drawing-of-the-ottoman-qur-an-revealing-the-secrets-of-the-tongue/ANWAR%20AL-BAYAN%20IN%20THE%20DRAWING%20OF%20THE%20OTTOMAN%20QUR%27AN%20%20%20REVEALING%20THE%20SECRETS%20OF%20THE%20TONGUE_djvu.txt",
                            "archive_pdf": "https://dn721503.ca.archive.org/0/items/anwar-al-bayan-in-the-drawing-of-the-ottoman-qur-an-revealing-the-secrets-of-the-tongue/ANWAR%20AL-BAYAN%20IN%20THE%20DRAWING%20OF%20THE%20OTTOMAN%20QUR%27AN%20%20%20REVEALING%20THE%20SECRETS%20OF%20THE%20TONGUE.pdf",
                            "cover": "books/anwar-al-bayan/en/cover-en.png"
                        },
                        "page": {
                            "ar": "books/anwar-al-bayan/ar/index.html",
                            "en": "books/anwar-al-bayan/en/index.html"
                        }
                    },
                    "cover": {
                        "ar": "https://nasserhabitat.github.io/nasser-books/books/anwar-al-bayan/ar/cover-ar.png",
                        "en": "https://nasserhabitat.github.io/nasser-books/books/anwar-al-bayan/en/cover-en.png"
                    },
                    "ai_access": {
                        "structured_data": true,
                        "api_accessible": true,
                        "content_analysis": true,
                        "formats": ["html", "pdf", "txt"],
                        "topics": ["Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¹Ø«Ù…Ø§Ù†ÙŠ", "Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø¹Ø«Ù…Ø§Ù†ÙŠ", "Ø£Ø³Ø±Ø§Ø± Ø§Ù„Ù„Ø³Ø§Ù†", "Ø£Ù†ÙˆØ§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†", "ØªØ¯Ø¨Ø± Ø§Ù„Ù‚Ø±Ø¢Ù†", "Ø§Ù„Ù…Ø®Ø·ÙˆØ·Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ©", "Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©", "Ø¹Ù„ÙˆÙ… Ø§Ù„Ù‚Ø±Ø¢Ù†", "Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…", "Ø§Ù„ÙÙ‡Ù… Ø§Ù„Ø¹Ù…ÙŠÙ‚", "Ø§Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠØ©", "Ø§Ù„ØªÙØ³ÙŠØ±", "Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ø±Ø¨ÙŠ", "Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠØ©"]
                    },
                    "content_ar": null,
                    "content_en": null,
                    "publishedDate": "2025-01-22T12:00:00Z"
                },
                // ... (Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙƒØªØ¨ Ù‡Ù†Ø§ØŒ Ø§Ø®ØªØµØ±ØªÙ‡Ø§ Ù„Ù„Ø§Ø®ØªØµØ§Ø±ØŒ Ø£Ø¶Ù Ø§Ù„Ø¨Ø§Ù‚ÙŠ ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ø£ØµÙ„)
            ]
        };

        let allBooks = [...libraryBooks.books];
        let bookContent = {};
        const formatsMap = {
            'docx': 'DOCX',
            'html': 'HTML',
            'pdf': 'PDF',
            'text': 'TEXT',
            'pdf_external': 'External PDF',
            'text_external': 'External TEXT',
            'archive_text': 'Archive Text',
            'archive_pdf': 'Archive PDF'
        };
        const langMap = {
            'ar': {
                'pdf_label': 'ØªØ­Ù…ÙŠÙ„ PDF',
                'read_more_label': 'Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„',
                'formats_title': 'Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„',
                'no_desc': 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ Ù…ØªØ§Ø­.',
                'more_link_label': 'Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ø²ÙŠØ¯',
                'read_direct_label': 'Ù‚Ø±Ø§Ø¡Ø© Ù…Ø¨Ø§Ø´Ø±Ø©'
            },
            'en': {
                'pdf_label': 'Download PDF',
                'read_more_label': 'Download Links',
                'formats_title': 'Download Links',
                'no_desc': 'No description available.',
                'more_link_label': 'Read More',
                'read_direct_label': 'Read Directly'
            }
        };

        // Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙƒÙˆØ¯ JavaScript Ù‡Ù†Ø§ØŒ Ù…Ø¹ Ø¥ØµÙ„Ø§Ø­ Ø£ÙŠ Ø£Ø®Ø·Ø§Ø¡ Ù†Ø­ÙˆÙŠØ© Ø£Ùˆ Ù…Ù†Ø·Ù‚ÙŠØ© Ù…Ø­ØªÙ…Ù„Ø©
        // Ù…Ø«Ù„ Ø¥ÙƒÙ…Ø§Ù„ innerHTML ÙÙŠ createBookCard Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ØŒ Ø§ÙØªØ±Ø¶ Ø£Ù†Ù‡ ÙƒØ§Ù† Ù†Ø§Ù‚ØµØ§Ù‹ ÙÙŠ Ø§Ù„Ø£ØµÙ„

        function getLang() {
            return document.documentElement.lang || 'ar';
        }

        function updateLastUpdateTime() {
            const lastUpdateSpan = document.getElementById('last-update');
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' };
            lastUpdateSpan.textContent = now.toLocaleDateString('ar-EG', options);
        }

        function generateDownloadLinks(book, lang) {
            let linksHtml = '';
            const links = book.links[lang];
            if (links) {
                linksHtml += `<h3>${langMap[lang].formats_title}</h3>`;
                linksHtml += '<ul>';
                for (const key in links) {
                    if (links.hasOwnProperty(key) && formatsMap[key] && key !== 'cover') {
                        linksHtml += `<li><a href="${links[key]}" target="_blank">${formatsMap[key] || key.toUpperCase()}</a></li>`;
                    }
                }
                linksHtml += '</ul>';
            }
            return linksHtml;
        }

        function createBookCard(book, viewType = 'grid') {
            const lang = getLang();
            const card = document.createElement('div');
            card.className = 'book-card';
            card.setAttribute('data-category', book.category);
            card.setAttribute('data-ai-access', JSON.stringify(book.ai_access));
            card.setAttribute('data-id', book.id);

            const isNew = new Date(book.publishedDate) > new Date(Date.now() - 30 * 24 * 60 * 60 * 1000);
            const bookTitle = book[`title_${lang}`] || book.title_ar;
            const bookCover = book.cover[lang] || book.cover.ar;
            const bookDesc = book[`description_${lang}`] || langMap[lang].no_desc;
            const bookPages = book[`pages_${lang}`] || book.pages_ar || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';

            // Check for English version
            const hasEnglishVersion = book.links.page && book.links.page.en;

            // 1. Create the "EN" badge for the cover
            const enBadgeHtml = hasEnglishVersion ? '<span class="en-badge">EN</span>' : '';

            // 2. Create the "English Version" button and text link
            let englishVersionHtml = '';
            if (hasEnglishVersion) {
                englishVersionHtml = `
                    <button class="english-btn">English Version</button>
                    <p>Available in English</p>
                `;
            }

            // Check for "Read More" page link for the current language
            const hasPageLink = book.links.page && book.links.page[lang];
            const pageLinkHtml = hasPageLink ? `<a href="${book.links.page[lang]}" class="more-link">${langMap[lang].more_link_label}</a>` : '';

            card.innerHTML = `
                ${isNew ? `<span class="new-badge">${lang === 'ar' ? 'Ø¬Ø¯ÙŠØ¯' : 'New'}</span>` : ''}
                <div class="book-cover">
                    ${enBadgeHtml}
                    <img src="${bookCover}" alt="${bookTitle}">
                    <span class="ai-badge">AI Ready</span>
                </div>
                <div class="book-info">
                    <h2>${bookTitle}</h2>
                    <p class="author-pages">${book.author || 'Ù†Ø§ØµØ± Ø§Ø¨Ù† Ø¯Ø§ÙˆÙˆØ¯'} | ${bookPages} ØµÙØ­Ø©</p>
                    <p class="description">${bookDesc}</p>
                    <div class="ai-formats">
                        ${book.ai_access.formats.map(format => `<span>${format.toUpperCase()}</span>`).join('')}
                    </div>
                    ${generateDownloadLinks(book, lang)}
                    <button class="read-direct-btn">${langMap[lang].read_direct_label}</button>
                    ${englishVersionHtml}
                    ${pageLinkHtml}
                </div>
            `;

            // Add event listener for read button
            const readBtn = card.querySelector('.read-direct-btn');
            if (readBtn) {
                readBtn.addEventListener('click', () => openReader(book.id, lang));
            }

            return card;
        }

        // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¯ÙˆØ§Ù„ ÙƒÙ…Ø§ Ù‡ÙŠØŒ Ù…Ø¹ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø£Ø®Ø·Ø§Ø¡

        document.addEventListener('DOMContentLoaded', async function() {
            updateLastUpdateTime();
            loadBooks();
            await preloadBookContents();
            setupSearch();
            setupFilterButtons();
            setupNewBooksFilter();
            setupAdvancedFilters();
            setupViewOptions();
            
            const closeBtn = document.querySelector('.reader-close');
            if (closeBtn) {
                closeBtn.onclick = function() {
                    const modal = document.getElementById('reader-modal');
                    modal.style.display = "none";
                    document.getElementById('reader-container').innerHTML = '';
                }
            }

            window.onclick = function(event) {
                const modal = document.getElementById('reader-modal');
                if (event.target == modal) {
                    modal.style.display = "none";
                    document.getElementById('reader-container').innerHTML = '';
                }
            }
            
            setInterval(() => {
                updateLastUpdateTime();
            }, 3600000);
        });
    </script>

</body>
</html>

</DOCUMENT>
