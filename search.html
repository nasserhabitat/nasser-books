<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بحث متخصص - مكتبة ناصر ابن داوود</title>
    <style>
        :root {
            --primary-color: #1a5276;
            --secondary-color: #2980b9;
            --accent-color: #e74c3c;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem 0;
            text-align: center;
            border-radius: 0 0 20px 20px;
            margin-bottom: 2rem;
        }
        
        .search-section {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .search-tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 5px;
            margin-bottom: 2rem;
        }
        
        .search-tab {
            flex: 1;
            padding: 12px 20px;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .search-tab.active {
            background: var(--primary-color);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .search-input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e1e8ed;
            border-radius: 50px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(26, 82, 118, 0.1);
        }
        
        .search-btn {
            padding: 15px 30px;
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }
        
        .search-btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }
        
        .gcse-search {
            width: 100%;
        }
        
        .info-box {
            background: #e8f4fd;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            border-right: 4px solid var(--primary-color);
        }
        
        .schema-types {
            background: #f0f7ff;
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1.5rem 0;
        }
        
        .schema-types-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .schema-type {
            background: var(--primary-color);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        .book-card {
            background: white;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 1px solid #e1e8ed;
        }
        
        .book-title {
            color: #2c5f8a;
            margin-bottom: 0.5rem;
        }
        
        .book-description {
            color: #555;
            margin-bottom: 0.5rem;
        }
        
        .book-meta {
            color: #777;
            font-size: 0.9rem;
            margin: 10px 0;
        }
        
        .book-link {
            display: inline-block;
            padding: 10px 20px;
            background: var(--secondary-color);
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background 0.3s;
        }
        
        .book-link:hover {
            background: var(--primary-color);
        }
        
        @media (max-width: 768px) {
            .search-box {
                flex-direction: column;
            }
            
            .search-tabs {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>🔍 محرك البحث المتخصص</h1>
            <p>مكتبة ناصر ابن داوود - بحث متقدم باستخدام Schema.org</p>
        </div>
    </header>

    <div class="container">
        <!-- تبويبات البحث -->
        <div class="search-tabs">
            <div class="search-tab active" data-tab="google-search">بحث جوجل المتخصص</div>
            <div class="search-tab" data-tab="local-search">البحث المحلي</div>
            <div class="search-tab" data-tab="all-books">جميع الكتب</div>
        </div>

        <!-- بحث جوجل المتخصص -->
        <section class="search-section tab-content active" id="google-search">
            <h2>بحث جوجل المتخصص باستخدام Schema.org</h2>
            <p>ابحث في محتوى المكتبة مع نتائج مخصصة باستخدام أنواع Schema.org</p>
            
            <div class="info-box">
                <strong>💡 معلومة:</strong> هذا المحرك مخصص للبحث في الكتب والمواد الأكاديمية فقط
                <br>
                <strong>🔧 حالة المحرك:</strong> <span id="search-engine-status">مفعل - جاهز للاستخدام</span>
            </div>

            <!-- محرك بحث جوجل المخصص مع إعدادات محسنة -->
            <div class="search-container">
                <script async src="https://cse.google.com/cse.js?cx=87a2ea74c56054f92">
                </script>
                <div class="gcse-searchbox" data-resultsUrl="https://nasserhabitat.github.io/nasser-books/search-results.html"></div>
                <div class="gcse-searchresults" data-queryParameterName="search" 
                     data-enableImageSearch="false" 
                     data-enableOrderBy="true"
                     data-autoSearchOnLoad="false"
                     data-disableWebSearch="true"
                     data-enableHistory="true"
                     data-refinementStyle="link">
                </div>
            </div>

            <!-- صفحة نتائج البحث المنفصلة -->
            <div style="margin-top: 1rem; text-align: center;">
                <a href="search-results.html" style="color: var(--primary-color); text-decoration: none;">
                    📄 عرض صفحة نتائج البحث المنفصلة
                </a>
            </div>

            <!-- بحث يدوي دقيق -->
            <div style="margin-top: 2rem; padding: 1.5rem; background: #f8f9fa; border-radius: 10px;">
                <h3>بحث يدوي دقيق</h3>
                <p>للبحث الدقيق بدون مصطلحات إضافية:</p>
                <div class="search-box">
                    <input type="text" id="exactQuery" class="search-input" placeholder="أدخل المصطلح بدقة...">
                    <button class="search-btn" onclick="performExactSearch()">
                        بحث دقيق
                    </button>
                </div>
            </div>

            <!-- أنواع Schema.org -->
            <div class="schema-types">
                <h3>أنواع Schema.org المستخدمة:</h3>
                <div class="schema-types-list">
                    <span class="schema-type">Book</span>
                    <span class="schema-type">Article</span>
                    <span class="schema-type">ScholarlyArticle</span>
                    <span class="schema-type">CreativeWork</span>
                    <span class="schema-type">CollectionPage</span>
                    <span class="schema-type">WebPage</span>
                    <span class="schema-type">PublicationIssue</span>
                    <span class="schema-type">Chapter</span>
                    <span class="schema-type">Review</span>
                    <span class="schema-type">Person</span>
                </div>
            </div>
        </section>

        <!-- البحث المحلي -->
        <section class="search-section tab-content" id="local-search">
            <h2>البحث المحلي في المكتبة</h2>
            <p>ابحث في جميع الكتب باستخدام نظام البحث المدمج</p>
            
            <div class="search-box">
                <input type="text" id="localSearch" class="search-input" placeholder="ابحث في العناوين والمحتوى...">
                <button class="search-btn" onclick="performLocalSearch()">
                    بحث محلي
                </button>
            </div>
            
            <div id="localResults"></div>
        </section>

        <!-- جميع الكتب -->
        <section class="search-section tab-content" id="all-books">
            <h2>جميع الكتب المتاحة</h2>
            <p>استعرض جميع الكتب في المكتبة</p>
            <div id="allBooksList"></div>
        </section>
    </div>

    <script>
           // بيانات الكتب (32 كتاب 16 بالعربية و16 مترجمة بالإنجليزية  16 id من index.json)
        const booksData = [
    {
        "id": "conscious-contemplation",
        "titles": {
            "ar": "نحو تدبر واعٍ",
            "en": "Towards Conscious Contemplation"
        },
        "description": {
            "ar": "كتاب يشرح منهجية التدبر العميق للقرآن الكريم وتطبيقاته العصرية",
            "en": "A practical guide to deep understanding and applying the Noble Quran in the modern era"
        },
        "links": {
            "ar": {
                "text": "books/conscious-contemplation/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1ZjCEi5V3dye2T0fwpAExfnM9haDKhnQF"
            },
            "en": {
                "text": "books/conscious-contemplation/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1sWN_QZ-Ovmam3g2Y-I_a1OXkV4wFiqYb"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "quranic_studies",
            "pages_ar": 91,
            "pages_en": 126,
            "topics": ["تدبر القرآن", "فهم القرآن", "تطبيق القرآن", "منهجية التدبر", "القرآن في العصر الحديث", "نور العقل", "رقمنة المخطوطات القرآنية", "الرسم العثماني", "المخطوطات القرآنية الأصلية", "منهج حياة", "الفهم الواعي للقرآن", "آيات القرآن", "القرآن الكريم", "تدبر عملي", "ناصر ابن داوود"]
        }
    },
    {
        "id": "anwar-al-bayan",
        "titles": {
            "ar": "أنوار البيان في رسم المصحف العثماني: الكشف عن أسرار اللسان",
            "en": "Anwar Al-Bayan in the Drawing of the Ottoman Quran: Unveiling the Secrets of the Tongue"
        },
        "description": {
            "ar": "دراسة علمية متعمقة للرسم العثماني وأسراره اللغوية في فهم القرآن الكريم",
            "en": "A scientific study revealing the linguistic secrets of the Ottoman Quranic script"
        },
        "links": {
            "ar": {
                "text": "books/anwar-al-bayan/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1O0uafxgb-EXpmiOZaNnLEx73okvilKZl"
            },
            "en": {
                "text": "books/anwar-al-bayan/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1vo44VX03M_ZR-ISriWgqAteOrvG8HMu2"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "quranic_studies",
            "pages_ar": 161,
            "pages_en": 215,
            "topics": ["الرسم العثماني", "المصحف العثماني", "أسرار اللسان", "أنوار البيان", "تدبر القرآن", "المخطوطات الرقمية", "اللغة العربية", "علوم القرآن", "القرآن الكريم", "الفهم العميق", "الدراسات القرآنية", "التفسير", "الخط العربي", "الكتابة القرآنية"]
        }
    },
    {
        "id": "changing-the-concepts",
        "titles": {
            "ar": "تغيير المفاهيم",
            "en": "Changing the Concepts"
        },
        "description": {
            "ar": "دراسة تطبيقية لفقه اللسان القرآني وتحليل المصطلحات القرآنية",
            "en": "An applied study of the jurisprudence of the Quranic tongue and analysis of Quranic terminology"
        },
        "links": {
            "ar": {
                "text": "books/changing-the-concepts/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=11JcMS0au6I2EbZtsZPPnNdPNcwSJN43M"
            },
            "en": {
                "text": "books/changing-the-concepts/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1E5rvAlBpiJ5zEAK8uE8J95dhTbWs7CIh"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "quranic_studies",
            "pages_ar": 569,
            "pages_en": 829,
            "topics": ["تغيير المفاهيم", "المصطلحات القرآنية", "فقه اللسان القرآني", "التدبر القرآني", "المخطوطات القرآنية الأصلية", "الرقمنة", "الوعي", "الإصلاح والتجديد", "القرآن الكريم", "السنة النبوية", "الربوبية والألوهية", "النفس في القرآن", "العبادة", "القيم القرآنية", "التفكير النقدي", "الذكاء والفطرة", "الشرك والتوحيد", "الكون والإنسان", "القيامة واليوم الآخر", "الجنة والنار", "الآيات الكونية", "البيانات", "المصداق القرآني", "الحروف المقطعة", "النسخ", "الجن والشياطين", "الأعداد في القرآن", "القصص القرآني", "القتل والقتال", "بنو إسرائيل", "الخلافة الإنسانية", "الزوج والأزواج", "الرجال والنساء", "القبلة", "المسجد الحرام والمسجد الأقصى", "الكذب", "الحلال والحرام", "الضحك والبكاء", "الصيد", "حجر", "اليقين", "الذكر", "الدعاء", "الرزق", "الميزان", "الجلد والجلود", "البعوضة", "الاستغفار", "العرش والماء", "الخلق والتصوير", "البشر والإنسان", "الخيل والبغال والحمير", "المليكة والملائكة والروح", "الأمة الوسط", "السفه", "الشرق والغرب", "الصراط المستقيم", "اللغة العربية ولسان القرآن", "الفيل", "الرحيم", "إحياء البلد", "كلام الله", "رؤية الله", "التسليم", "الساعة", "الموتى والأموات", "الأصنام الفكرية", "الفجر", "القرآن نهر جارٍ", "استشعار معاني الحروف"]
        }
    },
    {
        "id": "editing-the-quranic-terminology-tome1",
        "titles": {
            "ar": "تحرير المصطلح القرآني: دراسة تطبيقية في فقه اللسان القرآني - المجلد 1",
            "en": "Clarifying the Qur'anic Terminology: An Applied Study in the Jurisprudence of the Qur'anic Tongue - Tome 1"
        },
        "description": {
            "ar": "دراسة تطبيقية في فقه اللسان القرآني، المجلد الأول",
            "en": "An applied study in the jurisprudence of the Qur'anic tongue, Tome 1"
        },
        "links": {
            "ar": {
                "text": "books/editing-the-quranic-terminology-tome1/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1leUIatsgsHLVlNw2mjnMpI_p6b3P-ooe"
            },
            "en": {
                "text": "books/editing-the-quranic-terminology-tome1/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=16yt6Xnbp3SO6rKML8nA3_1bbhBHvHGVp"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "quranic_studies",
            "pages_ar": 376,
            "pages_en": 486,
            "topics": ["تغيير المفاهيم", "المصطلحات القرآنية", "فقه اللسان القرآني", "التدبر القرآني", "المخطوطات القرآنية الأصلية", "الرقمنة", "الوعي", "الإصلاح والتجديد", "القرآن الكريم", "السنة النبوية", "الربوبية والألوهية", "النفس في القرآن", "العبادة", "القيم القرآنية", "التفكير النقدي", "الذكاء والفطرة", "الشرك والتوحيد", "الكون والإنسان", "القيامة واليوم الآخر", "الجنة والنار", "الآيات الكونية", "البيانات", "المصداق القرآني", "الحروف المقطعة", "النسخ", "الجن والشياطين", "الأعداد في القرآن", "القصص القرآني", "القتل والقتال", "بنو إسرائيل", "الخلافة الإنسانية", "الزوج والأزواج", "الرجال والنساء", "القبلة", "المسجد الحرام والمسجد الأقصى", "الكذب", "الحلال والحرام", "الضحك والبكاء", "الصيد", "حجر", "اليقين", "الذكر", "الدعاء", "الرزق", "الميزان", "الجلد والجلود", "البعوضة", "الاستغفار", "العرش والماء", "الخلق والتصوير", "البشر والإنسان", "الخيل والبغال والحمير", "المليكة والملائكة والروح", "الأمة الوسط", "السفه", "الشرق والغرب", "الصراط المستقيم", "اللغة العربية ولسان القرآن", "الفيل", "الرحيم", "إحياء البلد", "كلام الله", "رؤية الله", "التسليم", "الساعة", "الموتى والأموات", "الأصنام الفكرية", "الفجر", "القرآن نهر جارٍ", "استشعار معاني الحروف"]
        }
    },
    {
        "id": "editing-the-quranic-terminology-tome2",
        "titles": {
            "ar": "تحرير المصطلح القرآني: دراسة تطبيقية في فقه اللسان القرآني - المجلد 2",
            "en": "Clarifying the Qur'anic Terminology: An Applied Study in the Jurisprudence of the Qur'anic Tongue - Tome 2"
        },
        "description": {
            "ar": "دراسة تطبيقية في فقه اللسان القرآني، المجلد الثاني",
            "en": "An applied study in the jurisprudence of the Qur'anic tongue, Tome 2"
        },
        "links": {
            "ar": {
                "text": "books/editing-the-quranic-terminology-tome2/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1FB_k6Gr-zoqJhlt8t5ZaN8DWuhnHmJrW"
            },
            "en": {
                "text": "books/editing-the-quranic-terminology-tome2/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1ceHbTYwL1eVy_cuSPIZtU10u_IxXW9cU"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "quranic_studies",
            "pages_ar": 333,
            "pages_en": 473,
            "topics": ["تغيير المفاهيم", "المصطلحات القرآنية", "فقه اللسان القرآني", "التدبر القرآني", "المخطوطات القرآنية الأصلية", "الرقمنة", "الوعي", "الإصلاح والتجديد", "القرآن الكريم", "السنة النبوية", "الربوبية والألوهية", "النفس في القرآن", "العبادة", "القيم القرآنية", "التفكير النقدي", "الذكاء والفطرة", "الشرك والتوحيد", "الكون والإنسان", "القيامة واليوم الآخر", "الجنة والنار", "الآيات الكونية", "البيانات", "المصداق القرآني", "الحروف المقطعة", "النسخ", "الجن والشياطين", "الأعداد في القرآن", "القصص القرآني", "القتل والقتال", "بنو إسرائيل", "الخلافة الإنسانية", "الزوج والأزواج", "الرجال والنساء", "القبلة", "المسجد الحرام والمسجد الأقصى", "الكذب", "الحلال والحرام", "الضحك والبكاء", "الصيد", "حجر", "اليقين", "الذكر", "الدعاء", "الرزق", "الميزان", "الجلد والجلود", "البعوضة", "الاستغفار", "العرش والماء", "الخلق والتصوير", "البشر والإنسان", "الخيل والبغال والحمير", "المليكة والملائكة والروح", "الأمة الوسط", "السفه", "الشرق والغرب", "الصراط المستقيم", "اللغة العربية ولسان القرآن", "الفيل", "الرحيم", "إحياء البلد", "كلام الله", "رؤية الله", "التسليم", "الساعة", "الموتى والأموات", "الأصنام الفكرية", "الفجر", "القرآن نهر جارٍ", "استشعار معاني الحروف"]
        }
    },
    {
        "id": "editing-the-quranic-terminology-tome3",
        "titles": {
            "ar": "تحرير المصطلح القرآني: دراسة تطبيقية في فقه اللسان القرآني - المجلد 3",
            "en": "Clarifying the Qur'anic Terminology: An Applied Study in the Jurisprudence of the Qur'anic Tongue - Tome 3"
        },
        "description": {
            "ar": "دراسة تطبيقية في فقه اللسان القرآني، المجلد الثالث",
            "en": "An applied study in the jurisprudence of the Qur'anic tongue, Tome 3"
        },
        "links": {
            "ar": {
                "text": "books/editing-the-quranic-terminology-tome3/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=19VRBRp30lVRbl8mp1gUuKeJFLc6DFs9I"
            },
            "en": {
                "text": "books/editing-the-quranic-terminology-tome3/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1IKotg4vp51VIqjdmasl7nAt_LiXFRSWc"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "quranic_studies",
            "pages_ar": 229,
            "pages_en": 315,
            "topics": ["تغيير المفاهيم", "المصطلحات القرآنية", "فقه اللسان القرآني", "التدبر القرآني", "المخطوطات القرآنية الأصلية", "الرقمنة", "الوعي", "الإصلاح والتجديد", "القرآن الكريم", "السنة النبوية", "الربوبية والألوهية", "النفس في القرآن", "العبادة", "القيم القرآنية", "التفكير النقدي", "الذكاء والفطرة", "الشرك والتوحيد", "الكون والإنسان", "القيامة واليوم الآخر", "الجنة والنار", "الآيات الكونية", "البيانات", "المصداق القرآني", "الحروف المقطعة", "النسخ", "الجن والشياطين", "الأعداد في القرآن", "القصص القرآني", "القتل والقتال", "بنو إسرائيل", "الخلافة الإنسانية", "الزوج والأزواج", "الرجال والنساء", "القبلة", "المسجد الحرام والمسجد الأقصى", "الكذب", "الحلال والحرام", "الضحك والبكاء", "الصيد", "حجر", "اليقين", "الذكر", "الدعاء", "الرزق", "الميزان", "الجلد والجلود", "البعوضة", "الاستغفار", "العرش والماء", "الخلق والتصوير", "البشر والإنسان", "الخيل والبغال والحمير", "المليكة والملائكة والروح", "الأمة الوسط", "السفه", "الشرق والغرب", "الصراط المستقيم", "اللغة العربية ولسان القرآن", "الفيل", "الرحيم", "إحياء البلد", "كلام الله", "رؤية الله", "التسليم", "الساعة", "الموتى والأموات", "الأصنام الفكرية", "الفجر", "القرآن نهر جارٍ", "استشعار معاني الحروف"]
        }
    },
    {
        "id": "contemplation-in-the-mirror",
        "titles": {
            "ar": "التدبر في مرآة الرسوم",
            "en": "Contemplation in the Mirror of Drawings"
        },
        "description": {
            "ar": "تطبيقات عملية للمخطوطات الرقمية في تدبر القرآن الكريم",
            "en": "Practical applications of digital manuscripts in the contemplation of the Quran"
        },
        "links": {
            "ar": {
                "text": "books/contemplation-in-the-mirror/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1xXMuTe5wXd1gi9sMxSKZXX2oYcpX5EfW"
            },
            "en": {
                "text": "books/contemplation-in-the-mirror/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=125pGBM7XANEUErNS8ROKKh_P2Gqo2AcU"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "quranic_studies",
            "pages_ar": 251,
            "pages_en": 254,
            "topics": ["التدبر في مرآة الرسوم", "المخطوطات الرقمية", "تدبر القرآن", "الرسم العثماني", "تطبيقات عملية للقرآن", "فهم القرآن", "أسرار الرسم العثماني", "نور المخطوطات الرقمية", "أنوار البيان", "جداول المعاني", "ناصر ابن داوود"]
        }
    },
    {
        "id": "the-jurisprudence",
        "titles": {
            "ar": "فقه اللسان القرآني",
            "en": "The Jurisprudence of the Quranic Tongue"
        },
        "description": {
            "ar": "دراسة منهجية لفهم اللسان العربي القرآني ومنهجية تدبر النص الإلهي",
            "en": "A new approach to understanding the text and manuscript of the Quran"
        },
        "links": {
            "ar": {
                "text": "books/the-jurisprudence/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1ot2XILFBHDS3lom62mKvZIBCFooPkLI6"
            },
            "en": {
                "text": "books/the-jurisprudence/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1ohXcnyc7F1xCkGynpdh-GB2ayRJlpVfV"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "quranic_studies",
            "pages_ar": 592,
            "pages_en": 416,
            "topics": ["فقه اللسان القرآني", "فهم النص القرآني", "المخطوطات القرآنية", "الرسوم القرآنية", "التدبر", "المخطوطات الرقمية", "المفاهيم الجديدة", "التدبر التفاعلي", "رقمنة المخطوطات الأصلية", "المصاحف العثمانية", "فهم القرآن", "تطبيق القرآن", "قواعد اللسان العربي القرآني", "استنباط القواعد من النص القرآني", "الشواهد من المخطوطات الأصلية", "دلالات الحروف", "سبعا من المثاني", "الأزواج", "الترادف", "المنهج اللفظي", "المحكم والمتشابه", "السياق اللساني", "المصطلح القرآني", "الناسخ والمنسوخ", "تجديد الخطاب الديني", "الواقع المعاصر", "الكتابة القرآنية", "القرآن الكريم"]
        }
    },
    {
        "id": "digitizing",
        "titles": {
            "ar": "رقمنة المخطوطات القرآنية",
            "en": "Digitization of Quranic Manuscripts"
        },
        "description": {
            "ar": "دراسة منهجية لحفظ النص القرآني رقمياً وتطبيقاته",
            "en": "A methodological study for the digital preservation of the Quranic text and its applications"
        },
        "links": {
            "ar": {
                "text": "books/digitizing/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1JkXjPUssUOeC9Qbt7eKNUj4xfl2aCtR_"
            },
            "en": {
                "text": "books/digitizing/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1pQixa3HYKKSrDLNcOgQJ5rupR90mflng"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "digital_projects",
            "pages_ar": 177,
            "pages_en": 227,
            "topics": ["رقمنة المخطوطات القرآنية", "تدبر القرآن", "نهضة قرآنية رقمية", "فهم القرآن", "التكنولوجيا والقرآن", "المخطوطة الرقمية الشخصية", "الأصالة والمعاصرة", "التراث العلمي الإسلامي", "الذكاء الاصطناعي والقرآن", "مشروع قرآني", "تحديات رقمنة المخطوطات", "تسويق المشروع القرآني", "مستقبل التدبر القرآني", "نشر التدبرات", "بناء الثقة والشراكات", "التوعية والتثقيف"]
        }
    },
    {
        "id": "modesty",
        "titles": {
            "ar": "الحَيَاءُ - سياج الروح وبوصلة الفهم",
            "en": "Modesty: From the Energy of Modesty to the Key to Knowledge"
        },
        "description": {
            "ar": "دراسة معمقة للحياء كأداة معرفية وأخلاقية في فهم القرآن الكريم",
            "en": "An in-depth study of modesty as a cognitive and ethical tool in understanding the Quran"
        },
        "links": {
            "ar": {
                "text": "books/modesty/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1aRFyozeTPUJz551g9V_mYKIwJDs5a7e_"
            },
            "en": {
                "text": "books/modesty/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1Mz8VUKNtIR0w_ob-1FxrVOFGKK2rFpVY"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "faith_studies",
            "pages_ar": 46,
            "pages_en": 40,
            "topics": ["الحياء", "الأخلاق الإسلامية", "التربية الروحية", "القرآن الكريم"]
        }
    },
    {
        "id": "malakoot",
        "titles": {
            "ar": "وَلِيَكُونَ مِنَ الْمُوقِنِينَ: رحلة برهانية في ملكوت السماوات والأرض وما بينهما",
            "en": "And So That He May Be of the Certain Ones: A Demonstrative Journey in the Kingdom of the Heavens and the Earth and What is Between Them"
        },
        "description": {
            "ar": "رحلة برهانية في ملكوت السماوات والأرض وما بينهما",
            "en": "A DEMONSTRATIVE JOURNEY IN THE KINGDOM OF THE HEAVENS AND THE EARTH AND WHAT IS BETWEEN THEM"
        },
        "links": {
            "ar": {
                "text": "books/malakoot/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1vosJndUPs6glX6cwu4-81ScG_vdOxgi0"
            },
            "en": {
                "text": "books/malakoot/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=10woJi7fjOZKTuG1Mt-E2n4NElhfMM8sg"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "faith_studies",
            "pages_ar": 610,
            "pages_en": 797,
            "topics": ["اليقين", "ملكوت السماوات والأرض", "برهان", "رؤية الحقيقة", "القرآن", "الحقائق العلمية", "الوحي", "الفطرة", "الكون", "الخلق", "الخالق", "الأرض المسطحة", "الأرض الثابتة", "التفكر", "التدبر", "نظريات إسلامية", "شكل الكون", "الشمس", "القمر", "الكواكب", "علم الفلك"]
        }
    },
    {
        "id": "prostration-and-glorification-in-the-qur'an",
        "titles": {
            "ar": "السجود والتسبيح في القرآن: من التنزيه القلبي إلى الخضوع العملي",
            "en": "Prostration and Glorification in the Qur'an: From Heartfelt Purification to Practical Submission"
        },
        "description": {
            "ar": "من التنزيه القلبي إلى الخضوع العملي",
            "en": "FROM HEARTFELT PURIFICATION TO PRACTICAL SUBMISSION"
        },
        "links": {
            "ar": {
                "text": "books/prostration-and-glorification-in-the-qur'an/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1Ic6Us2cmPScuJPOYUzShq-GERNdXO-gx"
            },
            "en": {
                "text": "books/prostration-and-glorification-in-the-qur'an/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1-4pwIbiwFemrRSoMqGDGCgmPtEkiTlXD"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "faith_studies",
            "pages_ar": 131,
            "pages_en": 189,
            "topics": ["السجود", "التسبيح", "القرآن الكريم", "التنزيه القلبي", "الخضوع العملي", "منهج حياة", "الحمد المحمدي", "فقه اللسان القرآني", "العبودية"]
        }
    },
    {
        "id": "christ-and-mary-in-the-qur'an",
        "titles": {
            "ar": "المسيح ومريم في القرآن: من الرمز الباطني إلى النموذج الإنساني",
            "en": "Christ and Mary in the Qur'an: From the Esoteric Symbol to the Human Model"
        },
        "description": {
            "ar": "من الرمز الباطني إلى النموذج الإنساني",
            "en": "From the esoteric symbol to the human model"
        },
        "links": {
            "ar": {
                "text": "books/christ-and-mary-in-the-qur'an/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=12xfvS3lrXzU5EPijQGWWThmxoRPOdMDZ"
            },
            "en": {
                "text": "books/christ-and-mary-in-the-qur'an/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1YtX1Q9rjzo-qL6UXCDeklHUcjuKe9m6w"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "faith_studies",
            "pages_ar": 69,
            "pages_en": 94,
            "topics": ["المسيح", "مريم", "القرآن", "التدبر الباطني", "الرمز الباطني", "النموذج الإنساني", "نماذج الوعي", "التفسير الرمزي", "فقه اللسان القرآني", "نظام المثاني", "الكلمة", "برنامج إحيائي", "الوعي الجديد", "التحرر الفكري", "أسماء الله الحسنى", "الرفع الإلهي", "الولادة العذرية", "مريم الثائرة", "تحليل نفسي لمريم", "المحراب", "النصارى في القرآن", "قراءة علمية معاصرة"]
        }
    },
    {
        "id": "blood",
        "titles": {
            "ar": "الدم",
            "en": "Blood - the code of existence that we neglected"
        },
        "description": {
            "ar": "الدم - شفرة الوجود التي أهملناها",
            "en": "the code of existence that we neglected"
        },
        "links": {
            "ar": {
                "text": "books/blood/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1MVLKRtTXWWznmFzsmWHcqtxcabld7P4J"
            },
            "en": {
                "text": "books/blood/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=12zS2Xz_1Lnr6FUXGh20aEgyG7fvGdWol"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "faith_studies",
            "pages_ar": 119,
            "pages_en": 162,
            "topics": ["شفرة القرآن", "نظام التشغيل القرآني", "اللسان العربي القرآني", "فقه السبع المثاني", "المثاني القرآنية", "الرسم العثماني", "تدبر القرآن", "المنظومة القرآنية", "تفعيل النص القرآني", "الاقتران (القران)", "الدم – المحور الرئيسي للكتاب", "اللسان القرآني – المنهجية المعتمدة في التحليل", "المثاني (الأزواج الحرفية) – النظام الخفي للكلمات في القرآن", "الحروف المقطعة – رموز ودلالات في فواتح السور", "المعنى الحركي – الدلالة الديناميكية للكلمات القرآنية", "التدبر الجماعي – أسلوب فهم القرآن", "الشفرة القرآنية – تفسير الرموز والحروف", "التحريم والتذكية – الدم بين الحكم الشرعي والرمز الكوني", "الذكاة والتزكية – التطهير الروحي والفكري", "الضرب في الأرض – منهج التغيير والخروج من الجمود", "أسماء الحروف – دلالاتها الكونية والقرآنية", "الرمز الكوني – الدم كنموذج للنظام الكوني", "الوعي الإنساني – المسؤولية تجاه الدم كمسار حيوي", "التبرع بالدم – من منظور روحي وإنساني", "يأجوج ومأجوج – رمز للفوضى والعبث بالأنظمة الحيوية", "فقه اللسان العربي القرآني – المنهجية الشاملة لفهم النص", "الرمز الكوني في التشريع القرآني", "سفك الدماء والاستخلاف الإنساني", "الدم بين الحكم الشرعي والمعنى الروحي", "الشيفرة اللسانية لكلمة دم (د + م)", "المعراج النبوي ودورة النور الإلهي", "فقه اللسان القرآني", "التدبر القرآني المعاصر", "البنية اللغوية العميقة للحروف العربية", "المثاني القرآنية والمعنى الحركي", "العلاقة بين المادة والروح في القرآن", "الدم كبوابة روحية ومسار وعي إنساني", "فن التبرع بالدم ونهج الرحمة", "الدم في المجتمعات الحديثة – قراءة قرآنية علمية", "مكتبة ناصر ابن داوود – المعرفة المفتوحة والذكاء الاصطناعي"]
        }
    },
    {
        "id": "the-code-of-the-quran",
        "titles": {
            "ar": "شفرة القرآن",
            "en": "THE CODE OF THE QUR'AN"
        },
        "description": {
            "ar": "دليل التشغيل لعصر جديد",
            "en": "AN OPERATING MANUAL FOR A NEW AGE"
        },
        "links": {
            "ar": {
                "text": "nasser-books/books/the-code-of-the-quran/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1VHl1GET6K2Xlj1PcBWFybKw-VtjqPbMp"
            },
            "en": {
                "text": "books/the-code-of-the-quran/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1qGGETH0dyGOHvPWJhlygXQw9Lcs-poeU"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "faith_studies",
            "pages_ar": 353,
            "pages_en": 72,
            "topics": ["نظام التشغيل القرآني", "اللسان العربي القرآني", "فقه السبع المثاني", "المثاني القرآنية", "الرسم العثماني", "تدبر القرآن", "المنظومة القرآنية", "تفعيل النص القرآني", "الاقتران (القران)", "السيمات", "فقه اللسان القرآني", "نظرية الصفر اللغوي", "أسماء الحروف", "دلالات الحروف", "أسرار الحروف العربية", "التشغيل العملي للقرآن", "القرآن في العصر الرقمي", "الذكاء الاصطناعي والقرآن", "منهجية التدبر", "تحطيم الأصنام الفكرية", "التصوير الذاتي", "بناء الرب الداخلي", "الجنة الدنيوية", "ناصر ابن داوود", "مكتبة ناصر ابن داوود", "التدبر"]
        }
    },
    {
        "id": "names-in-the-holy",
        "titles": {
            "ar": "الأسماء الحسنى الوظيفية في القرآن الكريم: دراسة توقيفية تحليلية لدلالات التدبير الإلهي",
            "en": "The Functional Beautiful Names in the Holy Quran: An Analytical Discretionary Study of the Connotations of Divine Management"
        },
        "description": {
            "ar": "دراسة توقيفية تحليلية لدلالات التدبير الإلهي من خلال الأسماء الحسنى",
            "en": "An analytical discretionary study of the connotations of divine management through the Beautiful Names"
        },
        "links": {
            "ar": {
                "text": "books/names-in-the-holy/ar/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1yzexcZFd9MKtcyR_a-6EpFkjsmp2RPJD"
            },
            "en": {
                "text": "books/names-in-the-holy/en/content.txt",
                "text_external": "https://drive.google.com/uc?export=download&id=1MYa0vWDb1vBI5R7Ojq1bloO45txsVkdE"
            }
        },
        "metadata": {
            "author": "ناصر ابن داوود",
            "category": "faith_studies",
            "pages_ar": 193,
            "pages_en": 248,
            "topics": ["الأسماء الحسنى", "الأسماء الحسنى الوظيفية", "التدبير الإلهي", "القرآن الكريم", "دراسة توقيفية", "دلالات الأسماء الحسنى", "الإحصاء", "فهم سنن الكون", "اليقين", "الطمأنينة", "حل المشكلات", "الدعاء", "التوكل", "تطبيق الأسماء الحسنى", "المعرفة بالله", "أسرار الأسماء", "العلاقة بالله", "التأمل في القرآن"]
        }
    }
];
// ذاكرة تخزين مؤقت لمحتوى الكتب
    const bookContentCache = new Map();

    // === الدوال الرئيسية ===

    // تبديل التبويبات
    function initializeTabs() {
        const tabs = document.querySelectorAll('.search-tab');
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                tabs.forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                this.classList.add('active');
                const tabId = this.getAttribute('data-tab');
                const targetSection = document.getElementById(tabId);
                if (targetSection) {
                    targetSection.classList.add('active');
                }
            });
        });
    }

    // تحميل محتوى الكتاب
    async function loadBookContent(bookId, textUrl) {
        // التحقق من الذاكرة المؤقتة أولاً
        if (bookContentCache.has(bookId)) {
            return bookContentCache.get(bookId);
        }

        try {
            console.log(`📥 جاري تحميل محتوى الكتاب: ${bookId}`);
            
            // محاولة تحميل من الرابط الخارجي أولاً
            let response;
            if (textUrl.includes('drive.google.com') || textUrl.includes('http')) {
                response = await fetch(textUrl);
            } else {
                // إذا كان رابط محلي
                response = await fetch(textUrl);
            }
            
            if (!response.ok) {
                throw new Error(`فشل في تحميل الملف: ${response.status}`);
            }
            
            const content = await response.text();
            
            // تخزين في الذاكرة المؤقتة
            bookContentCache.set(bookId, content);
            
            console.log(`✅ تم تحميل محتوى الكتاب: ${bookId}`);
            return content;
            
        } catch (error) {
            console.error(`❌ خطأ في تحميل محتوى الكتاب ${bookId}:`, error);
            return null;
        }
    }

    // البحث في النص مع إظهار السطور
    function searchInText(content, query, maxLines = 5) {
        if (!content) return [];
        
        const lines = content.split('\n');
        const matchingLines = [];
        const queryLower = query.toLowerCase();
        
        for (let i = 0; i < lines.length; i++) {
            const line = lines[i].trim();
            if (line.toLowerCase().includes(queryLower)) {
                // إضافة سياق السطور
                const start = Math.max(0, i - 1);
                const end = Math.min(lines.length, i + 2);
                const context = lines.slice(start, end).map((l, idx) => ({
                    text: l.trim(),
                    isMatch: (start + idx) === i,
                    lineNumber: start + idx + 1
                }));
                
                matchingLines.push({
                    lineNumber: i + 1,
                    text: line,
                    context: context
                });
                
                if (matchingLines.length >= maxLines) break;
            }
        }
        
        return matchingLines;
    }

    // تظليل النص المطابق
    function highlightText(text, query) {
        const regex = new RegExp(`(${escapeRegex(query)})`, 'gi');
        return text.replace(regex, '<mark class="search-highlight">$1</mark>');
    }

    // تهريب الأحرف الخاصة في regex
    function escapeRegex(string) {
        return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    }

    // البحث المحلي مع عرض السطور
    async function performLocalSearch() {
        console.log('🔍 تشغيل البحث المحلي...');
        const query = document.getElementById('localSearch').value.trim();
        const resultsDiv = document.getElementById('localResults');
        
        if (!query) {
            resultsDiv.innerHTML = '<p style="color: #666; text-align: center; padding: 2rem;">الرجاء إدخال مصطلح للبحث</p>';
            return;
        }
        
        // عرض رسالة تحميل
        resultsDiv.innerHTML = `
            <div style="text-align: center; padding: 2rem;">
                <div style="display: inline-block; padding: 10px 20px; background: #e8f4fd; border-radius: 10px;">
                    <p>🔍 جاري البحث في نصوص الكتب...</p>
                    <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                        <div class="loading-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
        const searchResults = [];
        
        // البحث في كل كتاب
        for (const book of booksData) {
            console.log(`🔎 البحث في كتاب: ${book.titles.ar}`);
            
            const inTitle = book.titles.ar.toLowerCase().includes(query.toLowerCase()) || 
                           book.titles.en.toLowerCase().includes(query.toLowerCase());
            const inDescription = book.description.ar.toLowerCase().includes(query.toLowerCase()) || 
                                book.description.en.toLowerCase().includes(query.toLowerCase());
            const inTopics = book.metadata.topics.some(topic => 
                topic.toLowerCase().includes(query.toLowerCase())
            );
            
            let textMatches = [];
            
            // تحميل محتوى النص والبحث فيه
            const textUrl = book.links.ar.text_external || book.links.ar.text;
            if (textUrl) {
                const content = await loadBookContent(book.id, textUrl);
                if (content) {
                    textMatches = searchInText(content, query, 3);
                }
            }
            
            if (inTitle || inDescription || inTopics || textMatches.length > 0) {
                searchResults.push({
                    book: book,
                    inTitle: inTitle,
                    inDescription: inDescription,
                    inTopics: inTopics,
                    textMatches: textMatches,
                    score: (inTitle ? 3 : 0) + (inDescription ? 2 : 0) + (inTopics ? 1 : 0) + (textMatches.length > 0 ? 2 : 0)
                });
            }
        }
        
        // ترتيب النتائج حسب الأهمية
        searchResults.sort((a, b) => b.score - a.score);
        
        if (searchResults.length === 0) {
            resultsDiv.innerHTML = `
                <div style="text-align: center; padding: 2rem; color: #666;">
                    <p>⚠️ لم يتم العثور على نتائج لـ "<strong>${query}</strong>"</p>
                    <p>جرب استخدام مصطلحات بحث مختلفة</p>
                </div>
            `;
            return;
        }
        
        // عرض النتائج
        resultsDiv.innerHTML = `
            <h3 style="margin-bottom: 1rem; color: var(--primary-color);">
                نتائج البحث لـ "<span style="color: var(--accent-color);">${query}</span>" (${searchResults.length})
            </h3>
            ${searchResults.map(result => {
                const book = result.book;
                return `
                    <div class="book-card">
                        <h4 class="book-title">${book.titles.ar}</h4>
                        <p class="book-description">${book.description.ar}</p>
                        <div class="book-meta">
                            <strong>التصنيف:</strong> ${book.metadata.category} • 
                            <strong>الصفحات:</strong> ${book.metadata.pages_ar}
                        </div>
                        
                        ${result.textMatches.length > 0 ? `
                            <div style="margin-top: 1.5rem;">
                                <h5 style="color: var(--primary-color); margin-bottom: 0.5rem;">
                                    📖 المواضع التي وردت فيها الكلمة:
                                </h5>
                                <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; border-right: 3px solid var(--accent-color);">
                                    ${result.textMatches.map(match => `
                                        <div style="margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid #e1e8ed;">
                                            <div style="font-size: 0.8em; color: #666; margin-bottom: 0.3rem;">
                                                السطر ${match.lineNumber}
                                            </div>
                                            <div style="line-height: 1.6;">
                                                ${match.context.map(ctx => `
                                                    <div style="margin: 0.2rem 0; padding: 0.2rem 0.5rem; border-radius: 3px; ${ctx.isMatch ? 'background: #fff3cd;' : ''}">
                                                        ${ctx.isMatch ? '→ ' : ''}${highlightText(ctx.text, query)}
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                        
                        ${!result.textMatches.length && (result.inTitle || result.inDescription || result.inTopics) ? `
                            <div style="margin-top: 1rem; padding: 0.8rem; background: #e8f4fd; border-radius: 5px;">
                                <strong>موجود في:</strong> 
                                ${result.inTitle ? 'العنوان ' : ''}
                                ${result.inDescription ? 'الوصف ' : ''}
                                ${result.inTopics ? 'المواضيع' : ''}
                            </div>
                        ` : ''}
                        
                        <a href="books/${book.id}/ar/" target="_blank" class="book-link" style="margin-top: 1rem;">
                            📚 عرض الكتاب كاملاً
                        </a>
                    </div>
                `;
            }).join('')}
        `;
        
        console.log(`✅ تم العثور على ${searchResults.length} نتيجة`);
    }

    // عرض جميع الكتب
    function displayAllBooks() {
        console.log('📚 عرض جميع الكتب...');
        const booksList = document.getElementById('allBooksList');
        
        booksList.innerHTML = `
            <h3 style="margin-bottom: 1.5rem; color: var(--primary-color);">جميع الكتب المتاحة (${booksData.length})</h3>
            ${booksData.map(book => `
                <div class="book-card">
                    <h4 class="book-title">${book.titles.ar}</h4>
                    <p class="book-description">${book.description.ar}</p>
                    <div class="book-meta">
                        <strong>التصنيف:</strong> ${book.metadata.category} • 
                        <strong>الصفحات:</strong> ${book.metadata.pages_ar} •
                        <strong>المواضيع:</strong> ${book.metadata.topics.slice(0, 3).join('، ')}
                    </div>
                    <a href="books/${book.id}/ar/" target="_blank" class="book-link">
                        📚 عرض الكتاب
                    </a>
                </div>
            `).join('')}
        `;
        
        console.log('✅ تم عرض جميع الكتب');
    }

    // البحث الدقيق في جوجل
    function performExactSearch() {
        console.log('🎯 تشغيل البحث الدقيق...');
        const query = document.getElementById('exactQuery').value.trim();
        if (!query) {
            alert('الرجاء إدخال مصطلح البحث');
            return;
        }
        
        const exactQuery = `"${query}"`;
        const searchInput = document.querySelector('.gsc-input input');
        
        if (searchInput) {
            searchInput.value = exactQuery;
            const searchButton = document.querySelector('.gsc-search-button');
            if (searchButton) {
                searchButton.click();
                console.log('✅ تم تشغيل البحث في جوجل');
            } else {
                console.log('❌ لم يتم العثور على زر البحث في جوجل');
            }
        } else {
            console.log('❌ لم يتم تحميل محرك بحث جوجل بعد');
            alert('محرك البحث جوجل غير جاهز بعد. يرجى المحاولة مرة أخرى بعد ثوانٍ.');
        }
    }

    // === تهيئة الصفحة ===
    document.addEventListener('DOMContentLoaded', function() {
        console.log('🚀 تهيئة الصفحة...');
        
        // تهيئة التبويبات
        initializeTabs();
        
        // عرض جميع الكتب تلقائياً
        displayAllBooks();
        
        // تفعيل البحث عند الضغط على Enter
        document.getElementById('exactQuery')?.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') performExactSearch();
        });
        
        document.getElementById('localSearch')?.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') performLocalSearch();
        });
        
        // جعل الدوال متاحة عالمياً
        window.performLocalSearch = performLocalSearch;
        window.performExactSearch = performExactSearch;
        window.displayAllBooks = displayAllBooks;
        
        console.log('✅ الصفحة جاهزة!');
        console.log('📖 عدد الكتب المتاحة:', booksData.length);
    });

    // التحقق من أخطاء JavaScript
    window.addEventListener('error', function(e) {
        console.error('❌ خطأ في JavaScript:', e.error);
    });
</script>
</body>
</html>
